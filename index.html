<!doctype html>
<html lang="ko">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í•™ê¸‰ í¬ì¸íŠ¸ ê´€ë¦¬ í”Œë«í¼</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
    
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    
    html, body {
      height: 100%;
      overflow-x: hidden;
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #B29146 0%, #D4AF37 50%, #B8860B 100%);
      position: relative;
      overflow: hidden;
    }
    
    .gradient-bg::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.15) 0%, transparent 40%),
        radial-gradient(circle at 70% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.05) 50%, transparent 70%);
      pointer-events: none;
    }
    
    .gradient-bg::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 100px;
      background: linear-gradient(to top, rgba(248, 250, 249, 0.1) 0%, transparent 100%);
      pointer-events: none;
    }
    
    .card-shadow {
      box-shadow: 
        0 4px 6px -1px rgba(52, 97, 53, 0.1),
        0 2px 4px -1px rgba(52, 97, 53, 0.06),
        0 0 0 1px rgba(52, 97, 53, 0.05);
      backdrop-filter: blur(10px);
    }
    
    .feature-card {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(52, 97, 53, 0.1);
    }
    
    .feature-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(178, 145, 70, 0.1), transparent);
      transition: left 0.6s ease;
    }
    
    .feature-card:hover::before {
      left: 100%;
    }
    
    .feature-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 
        0 20px 25px -5px rgba(52, 97, 53, 0.15),
        0 10px 10px -5px rgba(52, 97, 53, 0.1),
        0 0 0 1px rgba(178, 145, 70, 0.2);
    }
    
    .btn-primary {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      background: linear-gradient(135deg, #346135 0%, #2d5530 100%);
      border: none;
      box-shadow: 
        0 4px 14px 0 rgba(52, 97, 53, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    
    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.6s ease;
    }
    
    .btn-primary:hover::before {
      left: 100%;
    }
    
    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 
        0 8px 25px 0 rgba(52, 97, 53, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
      background: linear-gradient(135deg, #3d6e3e 0%, #346135 100%);
    }
    
    .btn-primary:active {
      transform: translateY(-1px);
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(26, 46, 27, 0.7);
      backdrop-filter: blur(8px);
      z-index: 1000;
      overflow-y: auto;
    }
    
    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: modalFadeIn 0.3s ease-out;
    }
    
    .modal-content {
      background: linear-gradient(145deg, #ffffff 0%, #f8faf9 100%);
      border-radius: 20px;
      max-width: 450px;
      width: 90%;
      max-height: 90%;
      overflow-y: auto;
      margin: 0 auto;
      box-shadow: 
        0 25px 50px -12px rgba(52, 97, 53, 0.25),
        0 0 0 1px rgba(178, 145, 70, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
      animation: modalSlideIn 0.3s ease-out;
    }
    
    @keyframes modalFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes modalSlideIn {
      from { 
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
      }
      to { 
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    @media (max-width: 640px) {
      .modal-content {
        width: 95%;
        max-width: none;
        margin: 20px;
      }
    }
    
    .tab-button {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }
    
    .tab-button.active {
      border-bottom: 3px solid #346135;
      color: #346135;
      background: linear-gradient(to bottom, transparent 0%, rgba(52, 97, 53, 0.05) 100%);
    }
    
    .input-field {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid rgba(52, 97, 53, 0.2);
      background: linear-gradient(145deg, #ffffff 0%, #f8faf9 100%);
    }
    
    .input-field:focus {
      outline: none;
      border-color: #346135;
      box-shadow: 
        0 0 0 4px rgba(52, 97, 53, 0.1),
        0 4px 12px rgba(52, 97, 53, 0.15);
      background: #ffffff;
      transform: translateY(-1px);
    }
    
    .input-field:hover:not(:focus) {
      border-color: rgba(178, 145, 70, 0.4);
      box-shadow: 0 2px 8px rgba(52, 97, 53, 0.1);
    }
    
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(145deg, #ffffff 0%, #f8faf9 100%);
      padding: 16px 24px;
      border-radius: 12px;
      box-shadow: 
        0 10px 30px rgba(52, 97, 53, 0.3),
        0 0 0 2px rgba(178, 145, 70, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.9);
      z-index: 2000;
      display: none;
      animation: toastSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(10px);
      min-width: 280px;
      max-width: 400px;
    }
    
    .toast.show {
      display: block;
    }
    
    @keyframes toastSlideIn {
      from {
        transform: translateX(400px) scale(0.9);
        opacity: 0;
      }
      to {
        transform: translateX(0) scale(1);
        opacity: 1;
      }
    }
    
    .dashboard-tab {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-bottom: 3px solid transparent;
      position: relative;
    }
    
    .dashboard-tab.active {
      border-bottom-color: #346135;
      color: #346135;
      background: linear-gradient(to bottom, transparent 0%, rgba(52, 97, 53, 0.05) 100%);
    }
    
    .dashboard-tab.active::after {
      content: '';
      position: absolute;
      bottom: -3px;
      left: 50%;
      transform: translateX(-50%);
      width: 30px;
      height: 3px;
      background: linear-gradient(90deg, #346135, #B29146);
      border-radius: 2px;
    }
    
    .student-dashboard-tab {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-bottom: 3px solid transparent;
      position: relative;
    }
    
    .student-dashboard-tab.active {
      color: #346135;
      background: linear-gradient(to bottom, transparent 0%, rgba(52, 97, 53, 0.05) 100%);
    }
    
    .class-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(52, 97, 53, 0.1);
      background: linear-gradient(145deg, #f8faf9 0%, #ffffff 100%);
    }
    
    .class-card:hover {
      transform: translateY(-3px) scale(1.01);
      box-shadow: 
        0 8px 25px rgba(52, 97, 53, 0.15),
        0 0 0 1px rgba(178, 145, 70, 0.2);
      background: linear-gradient(145deg, #ffffff 0%, #f8faf9 100%);
    }
    
    .student-item {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(52, 97, 53, 0.1);
      background: linear-gradient(145deg, #ffffff 0%, #f8faf9 100%);
    }
    
    .student-item:hover {
      background: linear-gradient(145deg, #f8faf9 0%, #ffffff 100%);
      transform: translateX(4px);
      box-shadow: 
        0 4px 12px rgba(52, 97, 53, 0.1),
        0 0 0 1px rgba(178, 145, 70, 0.15);
    }
    
    .product-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(52, 97, 53, 0.1);
      background: linear-gradient(145deg, #ffffff 0%, #f8faf9 100%);
      position: relative;
      overflow: hidden;
    }
    
    .product-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(178, 145, 70, 0.1), transparent);
      transition: left 0.6s ease;
    }
    
    .product-card:hover::before {
      left: 100%;
    }
    
    .product-card:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: 
        0 12px 30px rgba(52, 97, 53, 0.15),
        0 0 0 1px rgba(178, 145, 70, 0.2);
      background: linear-gradient(145deg, #f8faf9 0%, #ffffff 100%);
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body><!-- Toast Notification -->
  <div id="toast" class="toast">
   <p id="toastMessage" class="text-sm font-medium"></p>
  </div><!-- Navigation -->
  <nav id="navbar" class="fixed w-full top-0 z-50 bg-white shadow-md">
   <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
     <div class="flex items-center"><span id="platformTitle" class="text-lg sm:text-xl lg:text-2xl font-bold text-purple-600 truncate">í•™ê¸‰ í¬ì¸íŠ¸ ê´€ë¦¬</span>
     </div>
     <div class="flex gap-2 sm:gap-3"><button id="loginBtn" class="px-3 sm:px-4 lg:px-6 py-2 text-green-700 font-semibold hover:bg-green-50 rounded-lg transition text-sm sm:text-base border border-green-200"> ë¡œê·¸ì¸ </button> <button id="signupBtn" class="px-3 sm:px-4 lg:px-6 py-2 bg-green-700 text-white font-semibold rounded-lg btn-primary text-sm sm:text-base whitespace-nowrap"> êµì‚¬ íšŒì›ê°€ì… </button>
     </div>
    </div>
   </div>
  </nav><!-- Hero Section -->
  <section class="gradient-bg pt-24 sm:pt-28 lg:pt-32 pb-16 sm:pb-20 lg:pb-24 px-4">
   <div class="max-w-7xl mx-auto text-center relative"><!-- ì¥ì‹ì  ìš”ì†Œ -->
    <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-4 w-20 h-1 bg-white opacity-30 rounded-full"></div>
    <div class="relative z-10">
     <h1 id="heroTitle" class="text-4xl sm:text-5xl lg:text-6xl xl:text-7xl font-black text-white mb-6 sm:mb-8 leading-tight"><span class="block sm:inline drop-shadow-2xl animate-pulse">ëª¨ë‘ê°€ ì¦ê±°ìš´</span> <span class="block sm:inline drop-shadow-2xl bg-gradient-to-r from-white via-yellow-100 to-amber-200 bg-clip-text text-transparent animate-bounce" style="text-shadow: 0 0 30px rgba(255,255,255,0.5), 0 0 60px rgba(255,255,255,0.3); animation-duration: 2s;">ìš°ë¦¬ë°˜ í¬ì¸íŠ¸ ì‹œìŠ¤í…œ</span></h1>
     <p id="heroSubtitle" class="text-lg sm:text-xl lg:text-2xl text-white opacity-95 mb-10 sm:mb-12 max-w-3xl mx-auto leading-relaxed drop-shadow-md">í¬ì¸íŠ¸ë¡œ í•™ìƒë“¤ì˜ ì„±ì¥ì„ ì‘ì›í•˜ì„¸ìš”</p>
     <div class="flex justify-center"><button id="ctaBtn" class="px-8 sm:px-10 py-4 sm:py-5 bg-white text-green-700 font-bold text-base sm:text-lg rounded-xl hover:bg-green-50 transition-all duration-300 shadow-2xl hover:shadow-3xl transform hover:-translate-y-2 hover:scale-105 border-2 border-white/20"> <span class="flex items-center gap-2"> ì§€ê¸ˆ ì‹œì‘í•˜ê¸° 
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
        </svg></span> </button>
     </div>
    </div><!-- í•˜ë‹¨ ì¥ì‹ ìš”ì†Œ -->
    <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-8">
     <div class="flex space-x-2">
      <div class="w-2 h-2 bg-white/40 rounded-full animate-pulse"></div>
      <div class="w-2 h-2 bg-white/60 rounded-full animate-pulse" style="animation-delay: 0.2s;"></div>
      <div class="w-2 h-2 bg-white/40 rounded-full animate-pulse" style="animation-delay: 0.4s;"></div>
     </div>
    </div>
   </div>
  </section><!-- Features Section -->
  <section class="py-12 sm:py-16 lg:py-20 px-4 bg-gray-50">
   <div class="max-w-7xl mx-auto">
    <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-center text-gray-800 mb-8 sm:mb-12 lg:mb-16">ì£¼ìš” ê¸°ëŠ¥</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
     <div class="feature-card bg-white p-6 sm:p-8 rounded-xl card-shadow">
      <div class="text-4xl sm:text-5xl mb-4">
       ğŸ«
      </div>
      <h3 id="feature1Title" class="text-xl sm:text-2xl font-bold text-gray-800 mb-3">ê°„í¸í•œ í•™ê¸‰ ìƒì„±</h3>
      <p class="text-sm sm:text-base text-gray-600">ê³ ìœ í•œ í•™ê¸‰ì½”ë“œë¡œ í•™ê¸‰ì„ ìƒì„±í•˜ê³  í•™ìƒë“¤ì„ ì‰½ê²Œ ë“±ë¡í•˜ì„¸ìš”</p>
     </div>
     <div class="feature-card bg-white p-6 sm:p-8 rounded-xl card-shadow">
      <div class="text-4xl sm:text-5xl mb-4">
       â­
      </div>
      <h3 id="feature2Title" class="text-xl sm:text-2xl font-bold text-gray-800 mb-3">ì‹¤ì‹œê°„ í¬ì¸íŠ¸ ê´€ë¦¬</h3>
      <p class="text-sm sm:text-base text-gray-600">í•™ìƒë“¤ì˜ í™œë™ì— ë”°ë¼ í¬ì¸íŠ¸ë¥¼ ì¦‰ì‹œ ì§€ê¸‰í•˜ê³  ê´€ë¦¬í•˜ì„¸ìš”</p>
     </div>
     <div class="feature-card bg-white p-6 sm:p-8 rounded-xl card-shadow md:col-span-2 lg:col-span-1">
      <div class="text-4xl sm:text-5xl mb-4">
       ğŸ›’
      </div>
      <h3 id="feature3Title" class="text-xl sm:text-2xl font-bold text-gray-800 mb-3">í¬ì¸íŠ¸ ë§ˆì¼“ ì‹œìŠ¤í…œ</h3>
      <p class="text-sm sm:text-base text-gray-600">í•™ìƒë“¤ì´ í¬ì¸íŠ¸ë¡œ ìƒí’ˆì„ êµ¬ë§¤í•  ìˆ˜ ìˆëŠ” ë§ˆì¼“ì„ ìš´ì˜í•˜ì„¸ìš”</p>
     </div>
    </div>
   </div>
  </section><!-- Footer Section -->
  <footer class="py-8 px-4 bg-white border-t border-gray-200">
   <div class="max-w-7xl mx-auto text-center">
    <div class="flex justify-center gap-6 mb-4"><button id="privacyBtn" class="text-gray-600 hover:text-gray-800 text-sm font-medium underline transition"> ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ </button> <button id="termsBtn" class="text-gray-600 hover:text-gray-800 text-sm font-medium underline transition"> ì´ìš©ì•½ê´€ </button> <button id="qaBtn" class="text-gray-600 hover:text-gray-800 text-sm font-medium underline transition"> Q&amp;Aì†Œí†µë°© </button>
    </div>
    <p class="text-xs text-gray-500">Â© 2025 í•™êµëˆì´ ë•¡ë•¡ë•¡. All rights reserved.</p>
   </div>
  </footer><!-- Student Dashboard -->
  <div id="studentDashboard" style="display: none;" class="min-h-screen bg-gray-50">
   <div class="max-w-6xl mx-auto px-4 py-8"><!-- Dashboard Header -->
    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6 sm:mb-8">
     <div>
      <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">í•™ìƒ ëŒ€ì‹œë³´ë“œ</h1>
      <p id="studentWelcome" class="text-gray-600 mt-1 sm:mt-2 text-sm sm:text-base">í™˜ì˜í•©ë‹ˆë‹¤!</p>
     </div><button id="studentLogoutBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition text-sm sm:text-base self-start sm:self-auto"> ë¡œê·¸ì•„ì›ƒ </button>
    </div><!-- Student Info Card -->
    <div class="bg-white p-4 sm:p-6 rounded-xl shadow-md mb-6 sm:mb-8">
     <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6">
      <div class="text-center">
       <div class="text-2xl sm:text-3xl mb-2">
        ğŸ‘¤
       </div>
       <h3 class="font-semibold text-gray-800 text-sm sm:text-base">í•™ìƒ ì •ë³´</h3>
       <p id="studentInfo" class="text-gray-600 mt-1 text-sm sm:text-base"></p>
      </div>
      <div class="text-center">
       <div class="text-2xl sm:text-3xl mb-2">
        ğŸ«
       </div>
       <h3 class="font-semibold text-gray-800 text-sm sm:text-base">í•™ê¸‰ ì •ë³´</h3>
       <p id="classInfo" class="text-gray-600 mt-1 text-sm sm:text-base break-all"></p>
      </div>
      <div class="text-center">
       <div class="text-2xl sm:text-3xl mb-2">
        â­
       </div>
       <h3 class="font-semibold text-gray-800 text-sm sm:text-base">ë³´ìœ  í¬ì¸íŠ¸</h3>
       <p id="currentPoints" class="text-xl sm:text-2xl font-bold text-purple-600 mt-1">0P</p>
      </div>
     </div>
    </div><!-- Dashboard Tabs -->
    <div class="flex border-b mb-6 sm:mb-8 overflow-x-auto"><button id="studentPointsTab" class="student-dashboard-tab active px-4 sm:px-6 py-3 font-semibold text-gray-700 text-sm sm:text-base whitespace-nowrap"> í¬ì¸íŠ¸ ë‚´ì—­ </button> <button id="studentMarketTab" class="student-dashboard-tab px-4 sm:px-6 py-3 font-semibold text-gray-700 text-sm sm:text-base whitespace-nowrap"> ë§ˆì¼“ </button> <button id="studentItemsTab" class="student-dashboard-tab px-4 sm:px-6 py-3 font-semibold text-gray-700 text-sm sm:text-base whitespace-nowrap"> ë³´ìœ  ì•„ì´í…œ </button>
    </div><!-- Points History Tab -->
    <div id="studentPointsHistory" class="dashboard-content">
     <div class="bg-white p-6 rounded-xl shadow-md">
      <h3 class="text-xl font-bold text-gray-800 mb-4">í¬ì¸íŠ¸ ì§€ê¸‰ ë‚´ì—­</h3>
      <div id="studentPointsList" class="space-y-3">
       <p class="text-gray-500 text-center py-8">í¬ì¸íŠ¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
     </div>
    </div><!-- Market Tab -->
    <div id="studentMarket" class="dashboard-content" style="display: none;">
     <div class="bg-white p-6 rounded-xl shadow-md">
      <h3 class="text-xl font-bold text-gray-800 mb-4">ë§ˆì¼“ - í¬ì¸íŠ¸ë¡œ ìƒí’ˆ êµ¬ë§¤</h3>
      <div id="studentMarketProducts" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
       <p class="text-gray-500 text-center py-8 col-span-full">êµ¬ë§¤ ê°€ëŠ¥í•œ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
     </div>
    </div><!-- Items Tab -->
    <div id="studentItems" class="dashboard-content" style="display: none;">
     <div class="bg-white p-6 rounded-xl shadow-md">
      <h3 class="text-xl font-bold text-gray-800 mb-4">ë³´ìœ  ì•„ì´í…œ</h3>
      <div id="studentItemsList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
       <p class="text-gray-500 text-center py-8 col-span-full">ë³´ìœ í•œ ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
     </div>
    </div>
   </div>
  </div><!-- Purchase Confirmation Modal -->
  <div id="purchaseModal" class="modal">
   <div class="modal-content p-8">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-2xl font-bold text-gray-800">ìƒí’ˆ êµ¬ë§¤ í™•ì¸</h2><button id="closePurchase" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
    </div>
    <div id="purchaseDetails" class="mb-6"><!-- êµ¬ë§¤ ìƒí’ˆ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
    </div>
    <div class="flex gap-3"><button id="confirmPurchase" class="flex-1 py-3 bg-purple-600 text-white font-bold rounded-lg btn-primary"> êµ¬ë§¤ í™•ì¸ </button> <button id="cancelPurchase" class="flex-1 py-3 bg-gray-300 text-gray-700 font-bold rounded-lg"> ì·¨ì†Œ </button>
    </div>
   </div>
  </div><!-- Item Use Confirmation Modal -->
  <div id="useItemModal" class="modal">
   <div class="modal-content p-8">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-2xl font-bold text-gray-800">ì•„ì´í…œ ì‚¬ìš© í™•ì¸</h2><button id="closeUseItem" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
    </div>
    <div id="useItemDetails" class="mb-6"><!-- ì‚¬ìš©í•  ì•„ì´í…œ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
    </div>
    <div class="flex gap-3"><button id="confirmUseItem" class="flex-1 py-3 bg-green-600 text-white font-bold rounded-lg btn-primary"> ì‚¬ìš© </button> <button id="cancelUseItem" class="flex-1 py-3 bg-gray-300 text-gray-700 font-bold rounded-lg"> ì·¨ì†Œ </button>
    </div>
   </div>
  </div><!-- Teacher Dashboard -->
  <div id="teacherDashboard" style="display: none;" class="min-h-screen bg-gray-50">
   <div class="max-w-7xl mx-auto px-4 py-8"><!-- Dashboard Header -->
    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-6 sm:mb-8">
     <div>
      <h1 class="text-2xl sm:text-3xl font-bold text-gray-800">êµì‚¬ ëŒ€ì‹œë³´ë“œ</h1>
      <p id="teacherWelcome" class="text-gray-600 mt-1 sm:mt-2 text-sm sm:text-base">í™˜ì˜í•©ë‹ˆë‹¤!</p>
     </div><button id="logoutBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition text-sm sm:text-base self-start sm:self-auto"> ë¡œê·¸ì•„ì›ƒ </button>
    </div><!-- Dashboard Tabs -->
    <div class="flex border-b mb-6 sm:mb-8 overflow-x-auto"><button id="classTab" class="dashboard-tab active px-3 sm:px-4 lg:px-6 py-3 font-semibold text-gray-700 text-sm sm:text-base whitespace-nowrap"> í•™ê¸‰ ê´€ë¦¬ </button> <button id="studentsTab" class="dashboard-tab px-3 sm:px-4 lg:px-6 py-3 font-semibold text-gray-700 text-sm sm:text-base whitespace-nowrap"> í•™ìƒ ê´€ë¦¬ </button> <button id="pointsTab" class="dashboard-tab px-3 sm:px-4 lg:px-6 py-3 font-semibold text-gray-700 text-sm sm:text-base whitespace-nowrap"> í¬ì¸íŠ¸ ê´€ë¦¬ </button> <button id="marketTab" class="dashboard-tab px-3 sm:px-4 lg:px-6 py-3 font-semibold text-gray-700 text-sm sm:text-base whitespace-nowrap"> ë§ˆì¼“ ê´€ë¦¬ </button>
    </div><!-- Class Management Tab -->
    <div id="classManagement" class="dashboard-content">
     <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8"><!-- Create Class -->
      <div class="bg-white p-4 sm:p-6 rounded-xl shadow-md">
       <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-4">í•™ê¸‰ ìƒì„±</h3>
       <form id="createClassForm">
        <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ê¸‰ëª…</label> <input type="text" id="className" required class="input-field w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base" placeholder="ì˜ˆ: 3í•™ë…„ 1ë°˜">
        </div>
        <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ë…„</label> <select id="classGrade" required class="input-field w-full px-3 sm:px-4 py-2 sm:py-3 border border-gray-300 rounded-lg text-sm sm:text-base"> <option value="">í•™ë…„ ì„ íƒ</option> <option value="1">1í•™ë…„</option> <option value="2">2í•™ë…„</option> <option value="3">3í•™ë…„</option> <option value="4">4í•™ë…„</option> <option value="5">5í•™ë…„</option> <option value="6">6í•™ë…„</option> </select>
        </div><button type="submit" id="createClassBtn" class="w-full py-2 sm:py-3 bg-purple-600 text-white font-bold rounded-lg btn-primary text-sm sm:text-base"> í•™ê¸‰ ìƒì„± </button>
       </form>
      </div><!-- Class List -->
      <div class="bg-white p-4 sm:p-6 rounded-xl shadow-md">
       <h3 class="text-lg sm:text-xl font-bold text-gray-800 mb-4">ë‚´ í•™ê¸‰ ëª©ë¡</h3>
       <div id="classList" class="space-y-3">
        <p class="text-gray-500 text-center py-8 text-sm sm:text-base">ìƒì„±ëœ í•™ê¸‰ì´ ì—†ìŠµë‹ˆë‹¤</p>
       </div>
      </div>
     </div>
    </div><!-- Student Management Tab -->
    <div id="studentManagement" class="dashboard-content" style="display: none;">
     <div class="bg-white p-6 rounded-xl shadow-md mb-8">
      <h3 class="text-xl font-bold text-gray-800 mb-4">í•™ìƒ ì¼ê´„ ë“±ë¡</h3>
      <form id="bulkStudentForm">
       <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ê¸‰ ì„ íƒ</label> <select id="studentClassSelect" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg"> <option value="">í•™ê¸‰ì„ ì„ íƒí•˜ì„¸ìš”</option> </select>
       </div>
       <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ìƒ ëª©ë¡ (ë²ˆí˜¸,ì´ë¦„ í˜•ì‹ìœ¼ë¡œ í•œ ì¤„ì”© ì…ë ¥)</label> <textarea id="studentList" required rows="8" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ì˜ˆ:
1,ê¹€ì² ìˆ˜
2,ì´ì˜í¬
3,ë°•ë¯¼ìˆ˜"></textarea>
       </div><button type="submit" id="bulkStudentBtn" class="w-full py-3 bg-purple-600 text-white font-bold rounded-lg btn-primary"> í•™ìƒ ì¼ê´„ ë“±ë¡ </button>
      </form>
     </div><!-- Student List -->
     <div class="bg-white p-6 rounded-xl shadow-md">
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-4">
       <h3 class="text-xl font-bold text-gray-800">ë“±ë¡ëœ í•™ìƒ ëª©ë¡</h3>
       <div class="flex-shrink-0"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ê¸‰ë³„ ë³´ê¸°</label> <select id="studentFilterSelect" class="input-field px-4 py-2 border border-gray-300 rounded-lg text-sm"> <option value="">ì „ì²´ í•™ê¸‰</option> </select>
       </div>
      </div>
      <div id="registeredStudents" class="space-y-3">
       <p class="text-gray-500 text-center py-8">ë“±ë¡ëœ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
     </div>
    </div><!-- Points Management Tab -->
    <div id="pointsManagement" class="dashboard-content" style="display: none;">
     <div class="bg-white p-6 rounded-xl shadow-md mb-8">
      <h3 class="text-xl font-bold text-gray-800 mb-4">í¬ì¸íŠ¸ ì§€ê¸‰</h3>
      <form id="givePointsForm">
       <div class="grid md:grid-cols-2 gap-4 mb-4">
        <div><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ê¸‰ ì„ íƒ</label> <select id="pointsClassSelect" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg"> <option value="">í•™ê¸‰ì„ ì„ íƒí•˜ì„¸ìš”</option> </select>
        </div>
        <div><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ìƒ ì„ íƒ</label> <select id="pointsStudentSelect" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg"> <option value="">í•™ìƒì„ ì„ íƒí•˜ì„¸ìš”</option> </select>
        </div>
       </div>
       <div class="grid md:grid-cols-2 gap-4 mb-4">
        <div><label class="block text-sm font-semibold text-gray-700 mb-2">í¬ì¸íŠ¸</label> <input type="number" id="pointsAmount" required min="1" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ì§€ê¸‰í•  í¬ì¸íŠ¸">
        </div>
        <div><label class="block text-sm font-semibold text-gray-700 mb-2">ì‚¬ìœ </label> <input type="text" id="pointsReason" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="í¬ì¸íŠ¸ ì§€ê¸‰ ì‚¬ìœ ">
        </div>
       </div><button type="submit" id="givePointsBtn" class="w-full py-3 bg-purple-600 text-white font-bold rounded-lg btn-primary"> í¬ì¸íŠ¸ ì§€ê¸‰ </button>
      </form>
     </div><!-- Points History -->
     <div class="bg-white p-6 rounded-xl shadow-md">
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-4">
       <h3 class="text-xl font-bold text-gray-800">í¬ì¸íŠ¸ ì§€ê¸‰ ë‚´ì—­</h3>
       <div class="flex-shrink-0"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ê¸‰ë³„ ë³´ê¸°</label> <select id="pointsHistoryFilterSelect" class="input-field px-4 py-2 border border-gray-300 rounded-lg text-sm"> <option value="">ì „ì²´ í•™ê¸‰</option> </select>
       </div>
      </div>
      <div id="pointsHistory" class="space-y-3">
       <p class="text-gray-500 text-center py-8">í¬ì¸íŠ¸ ì§€ê¸‰ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
     </div>
    </div><!-- Market Management Tab -->
    <div id="marketManagement" class="dashboard-content" style="display: none;">
     <div class="bg-white p-6 rounded-xl shadow-md mb-8">
      <h3 class="text-xl font-bold text-gray-800 mb-4">ìƒí’ˆ ë“±ë¡</h3>
      <form id="addProductForm">
       <div class="grid md:grid-cols-2 gap-4 mb-4">
        <div><label class="block text-sm font-semibold text-gray-700 mb-2">ëŒ€ìƒ í•™ê¸‰</label> <select id="productClassSelect" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg"> <option value="">í•™ê¸‰ì„ ì„ íƒí•˜ì„¸ìš”</option> </select>
        </div>
        <div><label class="block text-sm font-semibold text-gray-700 mb-2">ìƒí’ˆëª…</label> <input type="text" id="productName" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ìƒí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
        </div>
       </div>
       <div class="grid md:grid-cols-2 gap-4 mb-4">
        <div><label class="block text-sm font-semibold text-gray-700 mb-2">í•„ìš” í¬ì¸íŠ¸</label> <input type="number" id="productPoints" required min="1" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="í•„ìš”í•œ í¬ì¸íŠ¸">
        </div>
        <div><label class="block text-sm font-semibold text-gray-700 mb-2">ì¬ê³  ìˆ˜ëŸ‰</label> <input type="number" id="productStock" required min="1" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ì¬ê³  ìˆ˜ëŸ‰">
        </div>
       </div>
       <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">ìƒí’ˆ ì„¤ëª…</label> <textarea id="productDescription" rows="3" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ìƒí’ˆì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
       </div><button type="submit" id="addProductBtn" class="w-full py-3 bg-purple-600 text-white font-bold rounded-lg btn-primary"> ìƒí’ˆ ë“±ë¡ </button>
      </form>
     </div><!-- Product List -->
     <div class="bg-white p-6 rounded-xl shadow-md">
      <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-4">
       <h3 class="text-xl font-bold text-gray-800">ë“±ë¡ëœ ìƒí’ˆ ëª©ë¡</h3>
       <div class="flex-shrink-0"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ê¸‰ë³„ ë³´ê¸°</label> <select id="productFilterSelect" class="input-field px-4 py-2 border border-gray-300 rounded-lg text-sm"> <option value="">ì „ì²´ í•™ê¸‰</option> </select>
       </div>
      </div>
      <div id="productList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
       <p class="text-gray-500 text-center py-8 col-span-full">ë“±ë¡ëœ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤</p>
      </div>
     </div>
    </div>
   </div>
  </div><!-- Signup Modal -->
  <div id="signupModal" class="modal">
   <div class="modal-content p-8">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-2xl font-bold text-gray-800">êµì‚¬ íšŒì›ê°€ì…</h2><button id="closeSignup" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
    </div>
    <form id="signupForm">
     <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">ì´ë¦„</label> <input type="text" id="signupName" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg">
     </div>
     <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™êµëª…</label> <input type="text" id="signupSchool" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg">
     </div>
     <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">ì•„ì´ë””</label> <input type="text" id="signupUserId" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ì˜ë¬¸, ìˆ«ì ì¡°í•© 4-20ì">
     </div>
     <div class="mb-6"><label class="block text-sm font-semibold text-gray-700 mb-2">ë¹„ë°€ë²ˆí˜¸</label> <input type="password" id="signupPassword" required minlength="6" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg">
     </div><button type="submit" id="signupSubmitBtn" class="w-full py-3 bg-purple-600 text-white font-bold rounded-lg btn-primary"> íšŒì›ê°€ì… </button>
    </form>
   </div>
  </div><!-- Privacy Policy Modal -->
  <div id="privacyModal" class="modal">
   <div class="modal-content p-8 max-w-4xl">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-2xl font-bold text-gray-800">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</h2><button id="closePrivacy" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
    </div>
    <div class="max-h-96 overflow-y-auto text-sm text-gray-700 space-y-4">
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ1ì¡° (ê°œì¸ì •ë³´ì˜ ì²˜ë¦¬ëª©ì )</h3>
      <p>í•™êµëˆì´ ë•¡ë•¡ë•¡ì€ ë‹¤ìŒì˜ ëª©ì ì„ ìœ„í•˜ì—¬ ê°œì¸ì •ë³´ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.</p>
      <ul class="list-disc ml-6 mt-2">
       <li>êµì‚¬ íšŒì›ê°€ì… ë° ê´€ë¦¬</li>
       <li>í•™ìƒ ì •ë³´ ê´€ë¦¬ ë° í¬ì¸íŠ¸ ì‹œìŠ¤í…œ ìš´ì˜</li>
       <li>ì„œë¹„ìŠ¤ ì œê³µ ë° ê°œì„ </li>
       <li>ê³ ê° ë¬¸ì˜ ë° ë¯¼ì› ì²˜ë¦¬</li>
       <li>ì„œë¹„ìŠ¤ ì´ìš© í†µê³„ ë¶„ì„</li>
      </ul>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ2ì¡° (ì²˜ë¦¬í•˜ëŠ” ê°œì¸ì •ë³´ì˜ í•­ëª©)</h3>
      <p>í•™êµëˆì´ ë•¡ë•¡ë•¡ì€ ë‹¤ìŒì˜ ê°œì¸ì •ë³´ í•­ëª©ì„ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
      <ul class="list-disc ml-6 mt-2">
       <li><strong>êµì‚¬ íšŒì›ê°€ì… ì‹œ:</strong> ì´ë¦„, í•™êµëª…, ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸</li>
       <li><strong>í•™ìƒ ì •ë³´:</strong> ì´ë¦„, ë²ˆí˜¸, í•™ê¸‰ ì •ë³´, í¬ì¸íŠ¸ ë‚´ì—­</li>
       <li><strong>ìë™ ìˆ˜ì§‘ ì •ë³´:</strong> ì„œë¹„ìŠ¤ ì´ìš© ê¸°ë¡, ì ‘ì† ë¡œê·¸</li>
      </ul>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ3ì¡° (ê°œì¸ì •ë³´ì˜ ì²˜ë¦¬ ë° ë³´ìœ ê¸°ê°„)</h3>
      <p>ê°œì¸ì •ë³´ëŠ” ìˆ˜ì§‘Â·ì´ìš©ì— ê´€í•œ ë™ì˜ì¼ë¡œë¶€í„° ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘Â·ì´ìš©ëª©ì ì„ ë‹¬ì„±í•  ë•Œê¹Œì§€ ë³´ìœ Â·ì´ìš©ë©ë‹ˆë‹¤.</p>
      <ul class="list-disc ml-6 mt-2">
       <li><strong>êµì‚¬ ê³„ì •:</strong> íšŒì› íƒˆí‡´ ì‹œê¹Œì§€</li>
       <li><strong>í•™ìƒ ì •ë³´:</strong> í•™ê¸‰ ìš´ì˜ ì¢…ë£Œ ì‹œê¹Œì§€</li>
       <li><strong>í¬ì¸íŠ¸ ë‚´ì—­:</strong> í•™ê¸‰ ìš´ì˜ ì¢…ë£Œ í›„ 1ë…„</li>
      </ul>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ4ì¡° (ê°œì¸ì •ë³´ì˜ ì œ3ì ì œê³µ)</h3>
      <p>ë³¸ í”Œë«í¼ì€ ì›ì¹™ì ìœ¼ë¡œ ê°œì¸ì •ë³´ë¥¼ ì œ3ìì—ê²Œ ì œê³µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ë§Œ, ë‹¤ìŒì˜ ê²½ìš°ì—ëŠ” ì˜ˆì™¸ë¡œ í•©ë‹ˆë‹¤:</p>
      <ul class="list-disc ml-6 mt-2">
       <li>ì •ë³´ì£¼ì²´ê°€ ì‚¬ì „ì— ë™ì˜í•œ ê²½ìš°</li>
       <li>ë²•ë ¹ì˜ ê·œì •ì— ì˜ê±°í•˜ê±°ë‚˜, ìˆ˜ì‚¬ ëª©ì ìœ¼ë¡œ ë²•ë ¹ì— ì •í•´ì§„ ì ˆì°¨ì™€ ë°©ë²•ì— ë”°ë¼ ìˆ˜ì‚¬ê¸°ê´€ì˜ ìš”êµ¬ê°€ ìˆëŠ” ê²½ìš°</li>
      </ul>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ5ì¡° (ê°œì¸ì •ë³´ì²˜ë¦¬ì˜ ìœ„íƒ)</h3>
      <p>ë³¸ í”Œë«í¼ì€ ê°œì¸ì •ë³´ ì²˜ë¦¬ì—…ë¬´ë¥¼ ì™¸ë¶€ì— ìœ„íƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í–¥í›„ ìœ„íƒì´ í•„ìš”í•œ ê²½ìš° ì‚¬ì „ì— ê³ ì§€í•˜ê² ìŠµë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ6ì¡° (ì •ë³´ì£¼ì²´ì˜ ê¶Œë¦¬Â·ì˜ë¬´ ë° í–‰ì‚¬ë°©ë²•)</h3>
      <p>ì •ë³´ì£¼ì²´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê¶Œë¦¬ë¥¼ í–‰ì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
      <ul class="list-disc ml-6 mt-2">
       <li>ê°œì¸ì •ë³´ ì—´ëŒ ìš”êµ¬</li>
       <li>ì˜¤ë¥˜ ë“±ì´ ìˆì„ ê²½ìš° ì •ì •Â·ì‚­ì œ ìš”êµ¬</li>
       <li>ì²˜ë¦¬ì •ì§€ ìš”êµ¬</li>
      </ul>
      <p class="mt-2">ê¶Œë¦¬ í–‰ì‚¬ëŠ” ê°œì¸ì •ë³´ë³´í˜¸ë²• ì‹œí–‰ê·œì¹™ ë³„ì§€ ì œ8í˜¸ì— ë”°ë¼ ì„œë©´, ì „ììš°í¸ ë“±ì„ í†µí•˜ì—¬ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ7ì¡° (ê°œì¸ì •ë³´ì˜ ì•ˆì „ì„± í™•ë³´ì¡°ì¹˜)</h3>
      <p>ê°œì¸ì •ë³´ì˜ ì•ˆì „ì„± í™•ë³´ë¥¼ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì¡°ì¹˜ë¥¼ ì‹œí–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤:</p>
      <ul class="list-disc ml-6 mt-2">
       <li>ê´€ë¦¬ì  ì¡°ì¹˜: ê°œì¸ì •ë³´ ì·¨ê¸‰ ì§ì›ì˜ ìµœì†Œí™” ë° êµìœ¡</li>
       <li>ê¸°ìˆ ì  ì¡°ì¹˜: ê°œì¸ì •ë³´ì²˜ë¦¬ì‹œìŠ¤í…œ ë“±ì˜ ì ‘ê·¼ê¶Œí•œ ê´€ë¦¬, ì ‘ê·¼í†µì œì‹œìŠ¤í…œ ì„¤ì¹˜</li>
       <li>ë¬¼ë¦¬ì  ì¡°ì¹˜: ì „ì‚°ì‹¤, ìë£Œë³´ê´€ì‹¤ ë“±ì˜ ì ‘ê·¼í†µì œ</li>
      </ul>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ8ì¡° (ê°œì¸ì •ë³´ ìë™ ìˆ˜ì§‘ ì¥ì¹˜ì˜ ì„¤ì¹˜Â·ìš´ì˜ ë° ê±°ë¶€ì— ê´€í•œ ì‚¬í•­)</h3>
      <p>ë³¸ í”Œë«í¼ì€ ì´ìš©ìì—ê²Œ ê°œë³„ì ì¸ ë§ì¶¤ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ ì´ìš©ì •ë³´ë¥¼ ì €ì¥í•˜ê³  ìˆ˜ì‹œë¡œ ë¶ˆëŸ¬ì˜¤ëŠ” 'ì¿ í‚¤(cookie)'ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ9ì¡° (ê°œì¸ì •ë³´ ë³´í˜¸ì±…ì„ì)</h3>
      <p>ê°œì¸ì •ë³´ ì²˜ë¦¬ì— ê´€í•œ ì—…ë¬´ë¥¼ ì´ê´„í•´ì„œ ì±…ì„ì§€ê³ , ê°œì¸ì •ë³´ ì²˜ë¦¬ì™€ ê´€ë ¨í•œ ì •ë³´ì£¼ì²´ì˜ ë¶ˆë§Œì²˜ë¦¬ ë° í”¼í•´êµ¬ì œë¥¼ ìœ„í•˜ì—¬ ê°œì¸ì •ë³´ ë³´í˜¸ì±…ì„ìë¥¼ ì§€ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
      <div class="bg-gray-50 p-3 rounded mt-2">
       <p><strong>ê°œì¸ì •ë³´ ë³´í˜¸ì±…ì„ì</strong></p>
       <p>ì„±ëª…: ìœ ì˜ì¬</p>
       <p>ì—°ë½ì²˜: manitomanager@gmail.com</p>
      </div>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ10ì¡° (ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ë³€ê²½)</h3>
      <p>ì´ ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ì€ ì‹œí–‰ì¼ë¡œë¶€í„° ì ìš©ë˜ë©°, ë²•ë ¹ ë° ë°©ì¹¨ì— ë”°ë¥¸ ë³€ê²½ë‚´ìš©ì˜ ì¶”ê°€, ì‚­ì œ ë° ì •ì •ì´ ìˆëŠ” ê²½ìš°ì—ëŠ” ë³€ê²½ì‚¬í•­ì˜ ì‹œí–‰ 7ì¼ ì „ë¶€í„° ê³µì§€ì‚¬í•­ì„ í†µí•˜ì—¬ ê³ ì§€í•  ê²ƒì…ë‹ˆë‹¤.</p>
      <p class="mt-2"><strong>ì‹œí–‰ì¼ì: 2025ë…„ 11ì›” 6ì¼</strong></p>
     </div>
    </div>
   </div>
  </div><!-- Terms of Service Modal -->
  <div id="termsModal" class="modal">
   <div class="modal-content p-8 max-w-4xl">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-2xl font-bold text-gray-800">ì´ìš©ì•½ê´€</h2><button id="closeTerms" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
    </div>
    <div class="max-h-96 overflow-y-auto text-sm text-gray-700 space-y-4">
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ1ì¡° (ëª©ì )</h3>
      <p>ì´ ì•½ê´€ì€ í•™êµëˆì´ ë•¡ë•¡ë•¡ì´ ì œê³µí•˜ëŠ” ì„œë¹„ìŠ¤ì˜ ì´ìš©ì¡°ê±´ ë° ì ˆì°¨, íšŒì‚¬ì™€ íšŒì›ê°„ì˜ ê¶Œë¦¬, ì˜ë¬´, ì±…ì„ì‚¬í•­ ë° ê¸°íƒ€ í•„ìš”í•œ ì‚¬í•­ì„ ê·œì •í•¨ì„ ëª©ì ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ2ì¡° (ì •ì˜)</h3>
      <ul class="list-disc ml-6">
       <li>"ì„œë¹„ìŠ¤"ë€ í•™ê¸‰ í¬ì¸íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
       <li>"íšŒì›"ì´ë€ ì„œë¹„ìŠ¤ì— ì ‘ì†í•˜ì—¬ ì´ ì•½ê´€ì— ë”°ë¼ ì„œë¹„ìŠ¤ë¥¼ ë°›ëŠ” êµì‚¬ë¥¼ ë§í•©ë‹ˆë‹¤.</li>
       <li>"í•™ìƒ"ì´ë€ êµì‚¬ê°€ ë“±ë¡í•œ í•™ê¸‰ì˜ êµ¬ì„±ì›ì„ ë§í•©ë‹ˆë‹¤.</li>
       <li>"í¬ì¸íŠ¸"ë€ í•™ìƒì˜ í™œë™ì— ë”°ë¼ ì§€ê¸‰ë˜ëŠ” ê°€ìƒì˜ ì ìˆ˜ë¥¼ ë§í•©ë‹ˆë‹¤.</li>
       <li>"ë§ˆì¼“"ì´ë€ í¬ì¸íŠ¸ë¥¼ ì´ìš©í•˜ì—¬ ìƒí’ˆì„ êµ¬ë§¤í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì„ ë§í•©ë‹ˆë‹¤.</li>
      </ul>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ3ì¡° (ì•½ê´€ì˜ íš¨ë ¥ ë° ë³€ê²½)</h3>
      <p>â‘  ì´ ì•½ê´€ì€ ì„œë¹„ìŠ¤ë¥¼ ì‹ ì²­í•œ ë•Œ ë˜ëŠ” íšŒì›ê°€ì…ì„ í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ë•Œë¶€í„° ì ìš©ë©ë‹ˆë‹¤.</p>
      <p>â‘¡ íšŒì‚¬ëŠ” í•„ìš”í•˜ë‹¤ê³  ì¸ì •ë˜ëŠ” ê²½ìš° ì´ ì•½ê´€ì„ ë³€ê²½í•  ìˆ˜ ìˆìœ¼ë©°, ë³€ê²½ëœ ì•½ê´€ì€ ì„œë¹„ìŠ¤ ë‚´ ê³µì§€ì‚¬í•­ì„ í†µí•´ ê³µì§€í•©ë‹ˆë‹¤.</p>
      <p>â‘¢ ë³€ê²½ëœ ì•½ê´€ì— ë™ì˜í•˜ì§€ ì•ŠëŠ” íšŒì›ì€ ì„œë¹„ìŠ¤ ì´ìš©ì„ ì¤‘ë‹¨í•˜ê³  íƒˆí‡´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ4ì¡° (ì„œë¹„ìŠ¤ì˜ ì œê³µ ë° ë³€ê²½)</h3>
      <p>â‘  íšŒì‚¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì—…ë¬´ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤:</p>
      <ul class="list-disc ml-6 mt-2">
       <li>í•™ê¸‰ ìƒì„± ë° ê´€ë¦¬ ì„œë¹„ìŠ¤</li>
       <li>í•™ìƒ í¬ì¸íŠ¸ ê´€ë¦¬ ì„œë¹„ìŠ¤</li>
       <li>í¬ì¸íŠ¸ ë§ˆì¼“ ì‹œìŠ¤í…œ ì œê³µ</li>
       <li>í•™ê¸‰ ìš´ì˜ í†µê³„ ë° ë¶„ì„ ì„œë¹„ìŠ¤</li>
      </ul>
      <p>â‘¡ íšŒì‚¬ëŠ” ì„œë¹„ìŠ¤ì˜ í’ˆì§ˆ í–¥ìƒì„ ìœ„í•´ ì„œë¹„ìŠ¤ ë‚´ìš©ì„ ë³€ê²½í•  ìˆ˜ ìˆìœ¼ë©°, ì¤‘ìš”í•œ ë³€ê²½ì‚¬í•­ì€ ì‚¬ì „ì— ê³µì§€í•©ë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ5ì¡° (íšŒì›ê°€ì…)</h3>
      <p>â‘  íšŒì›ê°€ì…ì€ êµì‚¬ë§Œ ê°€ëŠ¥í•˜ë©°, ì •í™•í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.</p>
      <p>â‘¡ íšŒì›ê°€ì… ì‹œ ì œê³µí•œ ì •ë³´ì— ë³€ê²½ì‚¬í•­ì´ ìˆì„ ê²½ìš° ì¦‰ì‹œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>
      <p>â‘¢ í—ˆìœ„ ì •ë³´ë¡œ ê°€ì…í•œ ê²½ìš° ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ6ì¡° (íšŒì›ì˜ ì˜ë¬´)</h3>
      <p>â‘  íšŒì›ì€ ë‹¤ìŒ í–‰ìœ„ë¥¼ í•˜ì—¬ì„œëŠ” ì•ˆë©ë‹ˆë‹¤:</p>
      <ul class="list-disc ml-6 mt-2">
       <li>íƒ€ì¸ì˜ ì •ë³´ ë„ìš©</li>
       <li>ì„œë¹„ìŠ¤ì˜ ì •ìƒì ì¸ ìš´ì˜ì„ ë°©í•´í•˜ëŠ” í–‰ìœ„</li>
       <li>ë¶€ì •í•œ ëª©ì ìœ¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ëŠ” í–‰ìœ„</li>
       <li>í•™ìƒì˜ ê°œì¸ì •ë³´ë¥¼ ë¶€ì ì ˆí•˜ê²Œ ì‚¬ìš©í•˜ëŠ” í–‰ìœ„</li>
       <li>í¬ì¸íŠ¸ ì‹œìŠ¤í…œì„ ì•…ìš©í•˜ëŠ” í–‰ìœ„</li>
      </ul>
      <p>â‘¡ íšŒì›ì€ í•™ìƒì˜ ê°œì¸ì •ë³´ ë³´í˜¸ì— ìµœì„ ì„ ë‹¤í•´ì•¼ í•©ë‹ˆë‹¤.</p>
      <p>â‘¢ íšŒì›ì€ êµìœ¡ ëª©ì ì— ë§ê²Œ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ì•¼ í•©ë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ7ì¡° (í•™ìƒ ì •ë³´ ê´€ë¦¬)</h3>
      <p>â‘  êµì‚¬ëŠ” í•™ìƒ ì •ë³´ ë“±ë¡ ì‹œ í•™ìƒ ë˜ëŠ” ë³´í˜¸ìì˜ ë™ì˜ë¥¼ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.</p>
      <p>â‘¡ í•™ìƒì˜ í¬ì¸íŠ¸ ì§€ê¸‰ì€ ê³µì •í•˜ê³  íˆ¬ëª…í•˜ê²Œ ì´ë£¨ì–´ì ¸ì•¼ í•©ë‹ˆë‹¤.</p>
      <p>â‘¢ í•™ê¸‰ ìš´ì˜ ì¢…ë£Œ ì‹œ í•™ìƒ ì •ë³´ëŠ” ì ì ˆíˆ ì²˜ë¦¬ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ8ì¡° (ì„œë¹„ìŠ¤ ì´ìš©ì œí•œ)</h3>
      <p>â‘  íšŒì‚¬ëŠ” íšŒì›ì´ ì´ ì•½ê´€ì˜ ì˜ë¬´ë¥¼ ìœ„ë°˜í•˜ê±°ë‚˜ ì„œë¹„ìŠ¤ì˜ ì •ìƒì ì¸ ìš´ì˜ì„ ë°©í•´í•œ ê²½ìš°, ì„œë¹„ìŠ¤ ì´ìš©ì„ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      <p>â‘¡ ì´ìš©ì œí•œì˜ ì¢…ë¥˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>
      <ul class="list-disc ml-6 mt-2">
       <li>ì„œë¹„ìŠ¤ ì´ìš© ê²½ê³ </li>
       <li>ì¼ì • ê¸°ê°„ ì„œë¹„ìŠ¤ ì´ìš© ì •ì§€</li>
       <li>íšŒì› ìê²© ë°•íƒˆ</li>
      </ul>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ9ì¡° (ì„œë¹„ìŠ¤ ì¤‘ë‹¨)</h3>
      <p>â‘  íšŒì‚¬ëŠ” ë‹¤ìŒì˜ ê²½ìš° ì„œë¹„ìŠ¤ ì œê³µì„ ì¼ì‹œì ìœ¼ë¡œ ì¤‘ë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
      <ul class="list-disc ml-6 mt-2">
       <li>ì‹œìŠ¤í…œ ì ê²€, ë³´ìˆ˜, êµì²´ ë° ê³ ì¥, í†µì‹  ë‘ì ˆ ë“±ì˜ ê²½ìš°</li>
       <li>ì •ì „, ì œë°˜ ì„¤ë¹„ì˜ ì¥ì•  ë˜ëŠ” ì´ìš©ëŸ‰ì˜ í­ì£¼ ë“±ìœ¼ë¡œ ì •ìƒì ì¸ ì„œë¹„ìŠ¤ ì´ìš©ì— ì§€ì¥ì´ ìˆëŠ” ê²½ìš°</li>
      </ul>
      <p>â‘¡ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì‹œ ì‚¬ì „ì— ê³µì§€í•˜ë©°, ë¶€ë“ì´í•œ ê²½ìš° ì‚¬í›„ì— ê³µì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ10ì¡° (ë©´ì±…ì¡°í•­)</h3>
      <p>â‘  íšŒì‚¬ëŠ” ì²œì¬ì§€ë³€, ì „ìŸ ë° ê¸°íƒ€ ì´ì— ì¤€í•˜ëŠ” ë¶ˆê°€í•­ë ¥ìœ¼ë¡œ ì¸í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì—ëŠ” ì„œë¹„ìŠ¤ ì œê³µì— ëŒ€í•œ ì±…ì„ì´ ë©´ì œë©ë‹ˆë‹¤.</p>
      <p>â‘¡ íšŒì‚¬ëŠ” íšŒì›ì˜ ê·€ì±…ì‚¬ìœ ë¡œ ì¸í•œ ì„œë¹„ìŠ¤ ì´ìš©ì˜ ì¥ì• ì— ëŒ€í•˜ì—¬ëŠ” ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ì œ11ì¡° (ë¶„ìŸí•´ê²°)</h3>
      <p>â‘  ì„œë¹„ìŠ¤ ì´ìš©ìœ¼ë¡œ ë°œìƒí•œ ë¶„ìŸì— ëŒ€í•´ íšŒì‚¬ì™€ íšŒì›ì€ ì„±ì‹¤íˆ í˜‘ì˜í•˜ì—¬ í•´ê²°í•˜ë„ë¡ ë…¸ë ¥í•©ë‹ˆë‹¤.</p>
      <p>â‘¡ í˜‘ì˜ë¡œ í•´ê²°ë˜ì§€ ì•ŠëŠ” ë¶„ìŸì€ ê´€ë ¨ ë²•ë ¹ì— ë”°ë¼ í•´ê²°í•©ë‹ˆë‹¤.</p>
     </div>
     <div>
      <h3 class="font-bold text-lg mb-2">ë¶€ì¹™</h3>
      <p>ì´ ì•½ê´€ì€ 2025ë…„ 11ì›” 6ì¼ë¶€í„° ì‹œí–‰ë©ë‹ˆë‹¤.</p>
     </div>
    </div>
   </div>
  </div><!-- Login Modal -->
  <div id="loginModal" class="modal">
   <div class="modal-content p-8">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-2xl font-bold text-gray-800">ë¡œê·¸ì¸</h2><button id="closeLogin" class="text-gray-500 hover:text-gray-700 text-2xl">Ã—</button>
    </div><!-- Login Tabs -->
    <div class="flex border-b mb-6"><button id="teacherTab" class="tab-button active flex-1 py-3 font-semibold text-gray-700"> êµì‚¬ ë¡œê·¸ì¸ </button> <button id="studentTab" class="tab-button flex-1 py-3 font-semibold text-gray-700"> í•™ìƒ ë¡œê·¸ì¸ </button>
    </div><!-- Teacher Login Form -->
    <form id="teacherLoginForm" class="login-form">
     <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">ì•„ì´ë””</label> <input type="text" id="teacherUserId" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg">
     </div>
     <div class="mb-6"><label class="block text-sm font-semibold text-gray-700 mb-2">ë¹„ë°€ë²ˆí˜¸</label> <input type="password" id="teacherPassword" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg">
     </div><button type="submit" id="teacherLoginBtn" class="w-full py-3 bg-purple-600 text-white font-bold rounded-lg btn-primary"> êµì‚¬ ë¡œê·¸ì¸ </button>
    </form><!-- Student Login Form -->
    <form id="studentLoginForm" class="login-form" style="display: none;">
     <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">í•™ê¸‰ ì½”ë“œ</label> <input type="text" id="studentClassCode" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ì˜ˆ: A1B2C3">
     </div>
     <div class="mb-4"><label class="block text-sm font-semibold text-gray-700 mb-2">ë²ˆí˜¸</label> <input type="number" id="studentNumber" required min="1" class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ì˜ˆ: 15">
     </div>
     <div class="mb-6"><label class="block text-sm font-semibold text-gray-700 mb-2">ì´ë¦„</label> <input type="text" id="studentName" required class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="ì˜ˆ: í™ê¸¸ë™">
     </div><button type="submit" id="studentLoginBtn" class="w-full py-3 bg-purple-600 text-white font-bold rounded-lg btn-primary"> í•™ìƒ ë¡œê·¸ì¸ </button>
    </form><!-- íšŒì›ê°€ì… ì•ˆë‚´ -->
    <div class="mt-6 text-center border-t pt-4">
     <p class="text-sm text-gray-600">ì•„ì§ ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”? <button id="switchToSignup" class="text-purple-600 hover:text-purple-700 font-semibold underline"> êµì‚¬ íšŒì›ê°€ì… </button></p>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      background_color: "#f8faf9",
      surface_color: "#ffffff",
      text_color: "#1a2e1b",
      primary_color: "#346135",
      secondary_color: "#B29146",
      font_family: "Market Sans",
      font_size: 16,
      platform_title: "í•™êµëˆì´ ë•¡ë•¡ë•¡",
      hero_title: "í•™ê¸‰ ê´€ë¦¬ì˜ ìƒˆë¡œìš´ ê¸°ì¤€",
      hero_subtitle: "í¬ì¸íŠ¸ë¡œ í•™ìƒë“¤ì˜ ì„±ì¥ì„ ì‘ì›í•˜ì„¸ìš”",
      feature1_title: "ê°„í¸í•œ í•™ê¸‰ ìƒì„±",
      feature2_title: "ì‹¤ì‹œê°„ í¬ì¸íŠ¸ ê´€ë¦¬",
      feature3_title: "í¬ì¸íŠ¸ ë§ˆì¼“ ì‹œìŠ¤í…œ"
    };

    let currentRecordCount = 0;
    let currentUser = null;
    let allData = [];

    const dataHandler = {
      onDataChanged(data) {
        currentRecordCount = data.length;
        allData = data;
        
        // êµì‚¬ ëŒ€ì‹œë³´ë“œê°€ í™œì„±í™”ëœ ê²½ìš° ë°ì´í„° ì—…ë°ì´íŠ¸
        if (currentUser && document.getElementById('teacherDashboard').style.display !== 'none') {
          updateDashboardData();
        }
        
        // í•™ìƒ ëŒ€ì‹œë³´ë“œê°€ í™œì„±í™”ëœ ê²½ìš° ë°ì´í„° ì—…ë°ì´íŠ¸
        if (currentUser && document.getElementById('studentDashboard').style.display !== 'none') {
          updateStudentDashboardData();
        }
      }
    };

    async function onConfigChange(config) {
      const backgroundColor = config.background_color || defaultConfig.background_color;
      const surfaceColor = config.surface_color || defaultConfig.surface_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseSize = config.font_size || defaultConfig.font_size;
      const baseFontStack = 'Inter, -apple-system, BlinkMacSystemFont, Segoe UI, sans-serif';

      document.body.style.backgroundColor = backgroundColor;
      document.body.style.color = textColor;
      document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;

      const navbar = document.getElementById('navbar');
      navbar.style.backgroundColor = surfaceColor;
      navbar.style.boxShadow = '0 4px 6px -1px rgba(52, 97, 53, 0.1), 0 2px 4px -1px rgba(52, 97, 53, 0.06)';

      const platformTitle = document.getElementById('platformTitle');
      platformTitle.textContent = config.platform_title || defaultConfig.platform_title;
      platformTitle.style.color = primaryColor;
      platformTitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      platformTitle.style.fontSize = `${baseSize * 1.5}px`;
      platformTitle.style.fontWeight = '800';

      const heroSection = document.querySelector('.gradient-bg');
      heroSection.style.background = secondaryColor;

      const heroTitle = document.getElementById('heroTitle');
      heroTitle.textContent = config.hero_title || defaultConfig.hero_title;
      heroTitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      heroTitle.style.fontSize = `${baseSize * 4}px`;

      const heroSubtitle = document.getElementById('heroSubtitle');
      heroSubtitle.textContent = config.hero_subtitle || defaultConfig.hero_subtitle;
      heroSubtitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      heroSubtitle.style.fontSize = `${baseSize * 1.25}px`;

      const feature1Title = document.getElementById('feature1Title');
      feature1Title.textContent = config.feature1_title || defaultConfig.feature1_title;
      feature1Title.style.fontFamily = `${customFont}, ${baseFontStack}`;
      feature1Title.style.fontSize = `${baseSize * 1.5}px`;
      feature1Title.style.color = textColor;

      const feature2Title = document.getElementById('feature2Title');
      feature2Title.textContent = config.feature2_title || defaultConfig.feature2_title;
      feature2Title.style.fontFamily = `${customFont}, ${baseFontStack}`;
      feature2Title.style.fontSize = `${baseSize * 1.5}px`;
      feature2Title.style.color = textColor;

      const feature3Title = document.getElementById('feature3Title');
      feature3Title.textContent = config.feature3_title || defaultConfig.feature3_title;
      feature3Title.style.fontFamily = `${customFont}, ${baseFontStack}`;
      feature3Title.style.fontSize = `${baseSize * 1.5}px`;
      feature3Title.style.color = textColor;

      const buttons = document.querySelectorAll('.btn-primary');
      buttons.forEach(btn => {
        btn.style.background = `linear-gradient(135deg, ${primaryColor} 0%, #2d5530 100%)`;
        btn.style.fontFamily = `${customFont}, ${baseFontStack}`;
        btn.style.fontWeight = '600';
      });

      const featureCards = document.querySelectorAll('.feature-card');
      featureCards.forEach(card => {
        card.style.background = `linear-gradient(145deg, ${surfaceColor} 0%, ${backgroundColor} 100%)`;
      });

      const modalContents = document.querySelectorAll('.modal-content');
      modalContents.forEach(modal => {
        modal.style.background = `linear-gradient(145deg, ${surfaceColor} 0%, ${backgroundColor} 100%)`;
      });

      // CSS ë³€ìˆ˜ë¡œ í…Œë§ˆìƒ‰ ì„¤ì •
      document.documentElement.style.setProperty('--primary-color', primaryColor);
      document.documentElement.style.setProperty('--secondary-color', secondaryColor);
      
      // í¬ì¸íŠ¸ ìƒ‰ìƒ ì—…ë°ì´íŠ¸
      const pointElements = document.querySelectorAll('[class*="purple-600"], [class*="green-600"]');
      pointElements.forEach(el => {
        if (el.textContent && el.textContent.includes('P')) {
          el.style.color = primaryColor;
        }
      });
    }

    async function initializeApp() {
      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          showToast('ë°ì´í„° ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤', 'error');
        }
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  config.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => config.surface_color || defaultConfig.surface_color,
                set: (value) => {
                  config.surface_color = value;
                  window.elementSdk.setConfig({ surface_color: value });
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  config.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => {
                  config.primary_color = value;
                  window.elementSdk.setConfig({ primary_color: value });
                }
              },
              {
                get: () => config.secondary_color || defaultConfig.secondary_color,
                set: (value) => {
                  config.secondary_color = value;
                  window.elementSdk.setConfig({ secondary_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["platform_title", config.platform_title || defaultConfig.platform_title],
            ["hero_title", config.hero_title || defaultConfig.hero_title],
            ["hero_subtitle", config.hero_subtitle || defaultConfig.hero_subtitle],
            ["feature1_title", config.feature1_title || defaultConfig.feature1_title],
            ["feature2_title", config.feature2_title || defaultConfig.feature2_title],
            ["feature3_title", config.feature3_title || defaultConfig.feature3_title]
          ])
        });
      }

      setupEventListeners();
    }

    function setupEventListeners() {
      document.getElementById('signupBtn').addEventListener('click', () => {
        document.getElementById('signupModal').classList.add('active');
      });

      document.getElementById('loginBtn').addEventListener('click', () => {
        document.getElementById('loginModal').classList.add('active');
      });

      document.getElementById('ctaBtn').addEventListener('click', () => {
        document.getElementById('loginModal').classList.add('active');
      });

      document.getElementById('qaBtn').addEventListener('click', () => {
        window.open('https://open.kakao.com/o/pL0eNL0h', '_blank', 'noopener,noreferrer');
      });

      document.getElementById('closeSignup').addEventListener('click', () => {
        document.getElementById('signupModal').classList.remove('active');
      });

      document.getElementById('closeLogin').addEventListener('click', () => {
        document.getElementById('loginModal').classList.remove('active');
      });

      document.getElementById('privacyBtn').addEventListener('click', () => {
        document.getElementById('privacyModal').classList.add('active');
      });

      document.getElementById('termsBtn').addEventListener('click', () => {
        document.getElementById('termsModal').classList.add('active');
      });

      document.getElementById('closePrivacy').addEventListener('click', () => {
        document.getElementById('privacyModal').classList.remove('active');
      });

      document.getElementById('closeTerms').addEventListener('click', () => {
        document.getElementById('termsModal').classList.remove('active');
      });

      document.getElementById('teacherTab').addEventListener('click', () => {
        document.getElementById('teacherTab').classList.add('active');
        document.getElementById('studentTab').classList.remove('active');
        document.getElementById('teacherLoginForm').style.display = 'block';
        document.getElementById('studentLoginForm').style.display = 'none';
      });

      document.getElementById('studentTab').addEventListener('click', () => {
        document.getElementById('studentTab').classList.add('active');
        document.getElementById('teacherTab').classList.remove('active');
        document.getElementById('studentLoginForm').style.display = 'block';
        document.getElementById('teacherLoginForm').style.display = 'none';
      });

      document.getElementById('signupForm').addEventListener('submit', handleSignup);
      document.getElementById('teacherLoginForm').addEventListener('submit', handleTeacherLogin);
      document.getElementById('studentLoginForm').addEventListener('submit', handleStudentLogin);

      // ëŒ€ì‹œë³´ë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document.getElementById('logoutBtn').addEventListener('click', handleLogout);
      document.getElementById('studentLogoutBtn').addEventListener('click', handleStudentLogout);
      
      // ëŒ€ì‹œë³´ë“œ íƒ­ ì´ë²¤íŠ¸
      document.getElementById('classTab').addEventListener('click', () => switchTab('classManagement', 'classTab'));
      document.getElementById('studentsTab').addEventListener('click', () => switchTab('studentManagement', 'studentsTab'));
      document.getElementById('pointsTab').addEventListener('click', () => switchTab('pointsManagement', 'pointsTab'));
      document.getElementById('marketTab').addEventListener('click', () => switchTab('marketManagement', 'marketTab'));
      
      // í•™ìƒ ëŒ€ì‹œë³´ë“œ íƒ­ ì´ë²¤íŠ¸
      document.getElementById('studentPointsTab').addEventListener('click', () => switchStudentTab('studentPointsHistory', 'studentPointsTab'));
      document.getElementById('studentMarketTab').addEventListener('click', () => switchStudentTab('studentMarket', 'studentMarketTab'));
      document.getElementById('studentItemsTab').addEventListener('click', () => switchStudentTab('studentItems', 'studentItemsTab'));
      
      // í¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document.getElementById('createClassForm').addEventListener('submit', handleCreateClass);
      document.getElementById('bulkStudentForm').addEventListener('submit', handleBulkStudentRegistration);
      document.getElementById('givePointsForm').addEventListener('submit', handleGivePoints);
      document.getElementById('addProductForm').addEventListener('submit', handleAddProduct);
      
      // í•™ê¸‰ ì„ íƒ ì‹œ í•™ìƒ ëª©ë¡ ì—…ë°ì´íŠ¸
      document.getElementById('pointsClassSelect').addEventListener('change', updateStudentOptions);
      
      // í•„í„° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      document.getElementById('studentFilterSelect').addEventListener('change', updateRegisteredStudents);
      document.getElementById('pointsHistoryFilterSelect').addEventListener('change', updatePointsHistory);
      document.getElementById('productFilterSelect').addEventListener('change', updateProductList);
      
      // êµ¬ë§¤ ëª¨ë‹¬ ì´ë²¤íŠ¸
      document.getElementById('closePurchase').addEventListener('click', () => {
        document.getElementById('purchaseModal').classList.remove('active');
      });
      document.getElementById('cancelPurchase').addEventListener('click', () => {
        document.getElementById('purchaseModal').classList.remove('active');
      });
      document.getElementById('confirmPurchase').addEventListener('click', handlePurchaseConfirm);
      
      // ì•„ì´í…œ ì‚¬ìš© ëª¨ë‹¬ ì´ë²¤íŠ¸
      document.getElementById('closeUseItem').addEventListener('click', () => {
        document.getElementById('useItemModal').classList.remove('active');
      });
      document.getElementById('cancelUseItem').addEventListener('click', () => {
        document.getElementById('useItemModal').classList.remove('active');
      });
      document.getElementById('confirmUseItem').addEventListener('click', handleUseItemConfirm);
      
      // íšŒì›ê°€ì… ëª¨ë‹¬ ì „í™˜
      document.getElementById('switchToSignup').addEventListener('click', () => {
        document.getElementById('loginModal').classList.remove('active');
        document.getElementById('signupModal').classList.add('active');
      });
    }

    async function handleSignup(e) {
      e.preventDefault();

      if (currentRecordCount >= 999) {
        showToast('ìµœëŒ€ 999ê°œì˜ ê³„ì •ë§Œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤', 'error');
        return;
      }

      const submitBtn = document.getElementById('signupSubmitBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ì²˜ë¦¬ ì¤‘...';

      const name = document.getElementById('signupName').value;
      const userId = document.getElementById('signupUserId').value;
      const school = document.getElementById('signupSchool').value;
      const password = document.getElementById('signupPassword').value;

      // ì•„ì´ë”” ì¤‘ë³µ í™•ì¸
      const existingUser = allData.find(user => 
        user.type === 'teacher' && user.userId === userId
      );

      if (existingUser) {
        submitBtn.disabled = false;
        submitBtn.textContent = 'íšŒì›ê°€ì…';
        showToast('ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì•„ì´ë””ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì•„ì´ë””ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
        return;
      }

      // ì•„ì´ë”” ìœ íš¨ì„± ê²€ì‚¬
      const userIdRegex = /^[a-zA-Z0-9]{4,20}$/;
      if (!userIdRegex.test(userId)) {
        submitBtn.disabled = false;
        submitBtn.textContent = 'íšŒì›ê°€ì…';
        showToast('ì•„ì´ë””ëŠ” ì˜ë¬¸, ìˆ«ì ì¡°í•©ìœ¼ë¡œ 4-20ìì—¬ì•¼ í•©ë‹ˆë‹¤.', 'error');
        return;
      }

      const result = await window.dataSdk.create({
        id: Date.now().toString(),
        type: 'teacher',
        userId: userId,
        password: password,
        name: name,
        school: school,
        createdAt: new Date().toISOString()
      });

      submitBtn.disabled = false;
      submitBtn.textContent = 'íšŒì›ê°€ì…';

      if (result.isOk) {
        showToast('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        document.getElementById('signupForm').reset();
        document.getElementById('signupModal').classList.remove('active');
      } else {
        showToast('íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
      }
    }

    async function handleTeacherLogin(e) {
      e.preventDefault();

      const submitBtn = document.getElementById('teacherLoginBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ë¡œê·¸ì¸ ì¤‘...';

      const userId = document.getElementById('teacherUserId').value;
      const password = document.getElementById('teacherPassword').value;

      // ë“±ë¡ëœ êµì‚¬ ê³„ì • í™•ì¸
      const teacher = allData.find(user => 
        user.type === 'teacher' && 
        user.userId === userId && 
        user.password === password
      );

      submitBtn.disabled = false;
      submitBtn.textContent = 'êµì‚¬ ë¡œê·¸ì¸';

      if (teacher) {
        currentUser = teacher;
        showTeacherDashboard();
        document.getElementById('teacherLoginForm').reset();
        showToast(`${teacher.name} ì„ ìƒë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`, 'success');
      } else {
        showToast('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤', 'error');
      }
    }

    async function handleStudentLogin(e) {
      e.preventDefault();

      const submitBtn = document.getElementById('studentLoginBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ë¡œê·¸ì¸ ì¤‘...';

      const classCode = document.getElementById('studentClassCode').value;
      const number = parseInt(document.getElementById('studentNumber').value);
      const name = document.getElementById('studentName').value;

      // í•™ìƒ ì •ë³´ í™•ì¸
      const student = allData.find(s => 
        s.type === 'student' && 
        s.classCode === classCode && 
        s.number === number && 
        s.name === name
      );

      setTimeout(() => {
        submitBtn.disabled = false;
        submitBtn.textContent = 'í•™ìƒ ë¡œê·¸ì¸';

        if (student) {
          currentUser = student;
          showStudentDashboard();
          document.getElementById('studentLoginForm').reset();
          showToast(`${student.name}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`, 'success');
        } else {
          showToast('í•™ê¸‰ì½”ë“œ, ë²ˆí˜¸, ì´ë¦„ì„ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”', 'error');
        }
      }, 1000);
    }

    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toastMessage');
      
      toastMessage.textContent = message;
      
      if (type === 'success') {
        toast.style.background = 'linear-gradient(135deg, #346135 0%, #2d5530 100%)';
        toast.style.color = 'white';
        toast.style.border = 'none';
      } else {
        toast.style.background = 'linear-gradient(135deg, #B29146 0%, #8B7355 100%)';
        toast.style.color = 'white';
        toast.style.border = 'none';
      }
      
      toastMessage.style.color = 'white';
      toastMessage.style.fontWeight = '600';
      toastMessage.style.fontSize = '14px';
      
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 2000);
    }

    function showTeacherDashboard() {
      // ë¡œê·¸ì¸ ëª¨ë‹¬ ë‹«ê¸°
      document.getElementById('loginModal').classList.remove('active');
      
      // ë„¤ë¹„ê²Œì´ì…˜ ë°” ìˆ¨ê¸°ê¸°
      document.getElementById('navbar').style.display = 'none';
      
      // ëœë”©í˜ì´ì§€ ìˆ¨ê¸°ê¸°
      const heroSection = document.querySelector('section.gradient-bg');
      const featuresSection = document.querySelector('section.py-12, section.py-16, section.py-20');
      if (heroSection) heroSection.style.display = 'none';
      if (featuresSection) featuresSection.style.display = 'none';
      
      // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
      document.querySelectorAll('section').forEach(section => {
        section.style.display = 'none';
      });
      
      // í‘¸í„° ìˆ¨ê¸°ê¸°
      document.querySelector('footer').style.display = 'none';
      
      // ëŒ€ì‹œë³´ë“œ ë³´ì´ê¸°
      document.getElementById('teacherDashboard').style.display = 'block';
      
      // í™˜ì˜ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
      document.getElementById('teacherWelcome').textContent = `${currentUser.name} ì„ ìƒë‹˜, í™˜ì˜í•©ë‹ˆë‹¤! (${currentUser.school})`;
      
      // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì—…ë°ì´íŠ¸
      updateDashboardData();
      
      // ê¸°ë³¸ íƒ­ì„ í•™ê¸‰ ê´€ë¦¬ë¡œ ì„¤ì •í•˜ê³  ëª¨ë“  ì½˜í…ì¸ ê°€ ë³´ì´ë„ë¡ í•¨
      switchTab('classManagement', 'classTab');
    }

    function showStudentDashboard() {
      // ë¡œê·¸ì¸ ëª¨ë‹¬ ë‹«ê¸°
      document.getElementById('loginModal').classList.remove('active');
      
      // ë„¤ë¹„ê²Œì´ì…˜ ë°” ìˆ¨ê¸°ê¸°
      document.getElementById('navbar').style.display = 'none';
      
      // ëœë”©í˜ì´ì§€ ìˆ¨ê¸°ê¸°
      const heroSection = document.querySelector('section.gradient-bg');
      const featuresSection = document.querySelector('section.py-12, section.py-16, section.py-20');
      if (heroSection) heroSection.style.display = 'none';
      if (featuresSection) featuresSection.style.display = 'none';
      
      // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
      document.querySelectorAll('section').forEach(section => {
        section.style.display = 'none';
      });
      
      // í‘¸í„° ìˆ¨ê¸°ê¸°
      document.querySelector('footer').style.display = 'none';
      
      // ëŒ€ì‹œë³´ë“œ ë³´ì´ê¸°
      document.getElementById('studentDashboard').style.display = 'block';
      
      // í•™ìƒ ì •ë³´ ì—…ë°ì´íŠ¸
      document.getElementById('studentWelcome').textContent = `${currentUser.name}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`;
      document.getElementById('studentInfo').textContent = `${currentUser.number}ë²ˆ ${currentUser.name}`;
      document.getElementById('classInfo').textContent = `${currentUser.className} (${currentUser.classCode})`;
      document.getElementById('currentPoints').textContent = `${currentUser.points || 0}P`;
      
      // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì—…ë°ì´íŠ¸
      updateStudentDashboardData();
      
      // ê¸°ë³¸ íƒ­ì„ í¬ì¸íŠ¸ ë‚´ì—­ìœ¼ë¡œ ì„¤ì •í•˜ê³  ëª¨ë“  ì½˜í…ì¸ ê°€ ë³´ì´ë„ë¡ í•¨
      switchStudentTab('studentPointsHistory', 'studentPointsTab');
    }

    function updateDashboardData() {
      updateClassList();
      updateStudentSelects();
      updateRegisteredStudents();
      updatePointsHistory();
      updateProductList();
    }

    function updateClassList() {
      const classList = document.getElementById('classList');
      const classes = allData.filter(item => item.type === 'class' && item.teacherId === currentUser.__backendId);
      
      if (classes.length === 0) {
        classList.innerHTML = '<p class="text-gray-500 text-center py-8">ìƒì„±ëœ í•™ê¸‰ì´ ì—†ìŠµë‹ˆë‹¤</p>';
        return;
      }
      
      classList.innerHTML = classes.map(cls => `
        <div class="class-card bg-gray-50 p-3 sm:p-4 rounded-lg border">
          <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-0">
            <div class="flex-1 min-w-0">
              <h4 class="font-semibold text-gray-800 text-sm sm:text-base truncate">${cls.name}</h4>
              <p class="text-xs sm:text-sm text-gray-600">${cls.grade}í•™ë…„</p>
            </div>
            <div class="text-left sm:text-right flex-shrink-0">
              <p class="text-xs sm:text-sm text-purple-600 font-semibold">í•™ê¸‰ì½”ë“œ</p>
              <p class="text-base sm:text-lg font-bold text-purple-800 font-mono">${cls.code}</p>
            </div>
          </div>
        </div>
      `).join('');
    }

    function updateStudentSelects() {
      const classes = allData.filter(item => item.type === 'class' && item.teacherId === currentUser.__backendId);
      
      const studentClassSelect = document.getElementById('studentClassSelect');
      const pointsClassSelect = document.getElementById('pointsClassSelect');
      const productClassSelect = document.getElementById('productClassSelect');
      const studentFilterSelect = document.getElementById('studentFilterSelect');
      const pointsHistoryFilterSelect = document.getElementById('pointsHistoryFilterSelect');
      const productFilterSelect = document.getElementById('productFilterSelect');
      
      const classOptions = classes.map(cls => 
        `<option value="${cls.__backendId}">${cls.name} (${cls.code})</option>`
      ).join('');
      
      const filterOptions = classes.map(cls => 
        `<option value="${cls.__backendId}">${cls.name}</option>`
      ).join('');
      
      studentClassSelect.innerHTML = '<option value="">í•™ê¸‰ì„ ì„ íƒí•˜ì„¸ìš”</option>' + classOptions;
      pointsClassSelect.innerHTML = '<option value="">í•™ê¸‰ì„ ì„ íƒí•˜ì„¸ìš”</option>' + classOptions;
      productClassSelect.innerHTML = '<option value="">í•™ê¸‰ì„ ì„ íƒí•˜ì„¸ìš”</option>' + classOptions;
      studentFilterSelect.innerHTML = '<option value="">ì „ì²´ í•™ê¸‰</option>' + filterOptions;
      pointsHistoryFilterSelect.innerHTML = '<option value="">ì „ì²´ í•™ê¸‰</option>' + filterOptions;
      productFilterSelect.innerHTML = '<option value="">ì „ì²´ í•™ê¸‰</option>' + filterOptions;
    }

    function updateRegisteredStudents() {
      const selectedClassId = document.getElementById('studentFilterSelect').value;
      let students = allData.filter(item => item.type === 'student' && item.teacherId === currentUser.__backendId);
      
      // í•™ê¸‰ í•„í„° ì ìš©
      if (selectedClassId) {
        students = students.filter(student => student.classId === selectedClassId);
      }
      
      const registeredStudents = document.getElementById('registeredStudents');
      
      if (students.length === 0) {
        const message = selectedClassId ? 'í•´ë‹¹ í•™ê¸‰ì— ë“±ë¡ëœ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤' : 'ë“±ë¡ëœ í•™ìƒì´ ì—†ìŠµë‹ˆë‹¤';
        registeredStudents.innerHTML = `<p class="text-gray-500 text-center py-8">${message}</p>`;
        return;
      }
      
      registeredStudents.innerHTML = students.map(student => `
        <div class="student-item flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-0 p-3 border rounded-lg">
          <div class="flex-1 min-w-0">
            <span class="font-semibold text-sm sm:text-base">${student.number}ë²ˆ ${student.name}</span>
            <span class="text-xs sm:text-sm text-gray-600 ml-0 sm:ml-2 block sm:inline">(${student.className})</span>
          </div>
          <div class="text-left sm:text-right flex-shrink-0">
            <span class="text-purple-600 font-semibold text-sm sm:text-base">${student.points || 0}P</span>
          </div>
        </div>
      `).join('');
    }

    function updatePointsHistory() {
      const selectedClassId = document.getElementById('pointsHistoryFilterSelect').value;
      let pointsHistory = allData.filter(item => item.type === 'points' && item.teacherId === currentUser.__backendId);
      
      // í•™ê¸‰ í•„í„° ì ìš©
      if (selectedClassId) {
        const classStudents = allData.filter(student => 
          student.type === 'student' && 
          student.classId === selectedClassId && 
          student.teacherId === currentUser.__backendId
        );
        const studentIds = classStudents.map(student => student.__backendId);
        pointsHistory = pointsHistory.filter(point => studentIds.includes(point.studentId));
      }
      
      const historyContainer = document.getElementById('pointsHistory');
      
      if (pointsHistory.length === 0) {
        const message = selectedClassId ? 'í•´ë‹¹ í•™ê¸‰ì˜ í¬ì¸íŠ¸ ì§€ê¸‰ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤' : 'í¬ì¸íŠ¸ ì§€ê¸‰ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤';
        historyContainer.innerHTML = `<p class="text-gray-500 text-center py-8">${message}</p>`;
        return;
      }
      
      // í•™ê¸‰ ì •ë³´ ì¶”ê°€ë¥¼ ìœ„í•´ í•™ìƒ ë°ì´í„°ì™€ ë§¤ì¹­
      const studentsMap = new Map();
      allData.filter(item => item.type === 'student' && item.teacherId === currentUser.__backendId)
        .forEach(student => studentsMap.set(student.__backendId, student));
      
      historyContainer.innerHTML = pointsHistory.slice(-10).reverse().map(point => {
        const student = studentsMap.get(point.studentId);
        const className = student ? student.className : 'ì•Œ ìˆ˜ ì—†ìŒ';
        
        return `
          <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 sm:gap-0 p-3 border rounded-lg">
            <div class="flex-1 min-w-0">
              <span class="font-semibold text-sm sm:text-base">${point.studentName}</span>
              <span class="text-xs sm:text-sm text-gray-600 ml-0 sm:ml-2 block sm:inline">(${className})</span>
              <span class="text-xs sm:text-sm text-gray-600 ml-0 sm:ml-2 block sm:inline">${point.reason}</span>
            </div>
            <div class="text-left sm:text-right flex-shrink-0">
              <span class="text-purple-600 font-semibold text-sm sm:text-base">+${point.amount}P</span>
              <p class="text-xs text-gray-500">${new Date(point.createdAt).toLocaleDateString()}</p>
            </div>
          </div>
        `;
      }).join('');
    }

    function updateProductList() {
      const selectedClassId = document.getElementById('productFilterSelect').value;
      let products = allData.filter(item => item.type === 'product' && item.teacherId === currentUser.__backendId);
      
      // í•™ê¸‰ í•„í„° ì ìš©
      if (selectedClassId) {
        products = products.filter(product => product.classId === selectedClassId);
      }
      
      const productList = document.getElementById('productList');
      
      if (products.length === 0) {
        const message = selectedClassId ? 'í•´ë‹¹ í•™ê¸‰ì— ë“±ë¡ëœ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤' : 'ë“±ë¡ëœ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤';
        productList.innerHTML = `<p class="text-gray-500 text-center py-8 col-span-full">${message}</p>`;
        return;
      }
      
      // í•™ê¸‰ ì •ë³´ ì¶”ê°€ë¥¼ ìœ„í•´ í•™ê¸‰ ë°ì´í„°ì™€ ë§¤ì¹­
      const classesMap = new Map();
      allData.filter(item => item.type === 'class' && item.teacherId === currentUser.__backendId)
        .forEach(cls => classesMap.set(cls.__backendId, cls));
      
      productList.innerHTML = products.map(product => {
        const productClass = classesMap.get(product.classId);
        const className = productClass ? productClass.name : 'ì•Œ ìˆ˜ ì—†ìŒ';
        
        return `
          <div class="product-card bg-white p-3 sm:p-4 rounded-lg border shadow-sm">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-semibold text-gray-800 text-sm sm:text-base truncate flex-1 mr-2">${product.name}</h4>
              <button 
                onclick="deleteProduct('${product.__backendId}')" 
                class="text-red-500 hover:text-red-700 text-lg font-bold leading-none flex-shrink-0"
                title="ìƒí’ˆ ì‚­ì œ"
              >
                Ã—
              </button>
            </div>
            <p class="text-xs sm:text-sm text-blue-600 mb-2 font-medium">${className}</p>
            <p class="text-xs sm:text-sm text-gray-600 mb-3 line-clamp-2">${product.description || 'ì„¤ëª… ì—†ìŒ'}</p>
            <div class="flex justify-between items-center">
              <span class="text-purple-600 font-bold text-sm sm:text-base">${product.points}P</span>
              <span class="text-xs sm:text-sm text-gray-500 whitespace-nowrap">ì¬ê³ : ${product.stock}ê°œ</span>
            </div>
          </div>
        `;
      }).join('');
    }

    function updateStudentDashboardData() {
      updateStudentPointsHistory();
      updateStudentMarket();
      updateStudentItems();
      
      // í˜„ì¬ í¬ì¸íŠ¸ ì—…ë°ì´íŠ¸
      const updatedStudent = allData.find(s => s.__backendId === currentUser.__backendId);
      if (updatedStudent) {
        currentUser = updatedStudent;
        document.getElementById('currentPoints').textContent = `${currentUser.points || 0}P`;
      }
    }

    function updateStudentPointsHistory() {
      const pointsHistory = allData.filter(item => 
        item.type === 'points' && 
        item.studentId === currentUser.__backendId
      );
      const historyContainer = document.getElementById('studentPointsList');
      
      if (pointsHistory.length === 0) {
        historyContainer.innerHTML = '<p class="text-gray-500 text-center py-8">í¬ì¸íŠ¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>';
        return;
      }
      
      historyContainer.innerHTML = pointsHistory.slice().reverse().map(point => `
        <div class="flex justify-between items-center p-4 border rounded-lg bg-green-50">
          <div>
            <p class="font-semibold text-gray-800">${point.reason}</p>
            <p class="text-sm text-gray-600">${new Date(point.createdAt).toLocaleDateString()}</p>
          </div>
          <div class="text-right">
            <span class="text-green-600 font-bold text-lg">+${point.amount}P</span>
          </div>
        </div>
      `).join('');
    }

    function updateStudentMarket() {
      const products = allData.filter(item => 
        item.type === 'product' && 
        item.teacherId === currentUser.teacherId &&
        item.classId === currentUser.classId &&
        item.stock > 0
      );
      const marketContainer = document.getElementById('studentMarketProducts');
      
      if (products.length === 0) {
        marketContainer.innerHTML = '<p class="text-gray-500 text-center py-8 col-span-full">êµ¬ë§¤ ê°€ëŠ¥í•œ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤</p>';
        return;
      }
      
      marketContainer.innerHTML = products.map(product => `
        <div class="product-card bg-white p-3 sm:p-4 rounded-lg border shadow-sm">
          <h4 class="font-semibold text-gray-800 mb-2 text-sm sm:text-base truncate">${product.name}</h4>
          <p class="text-xs sm:text-sm text-gray-600 mb-3 line-clamp-2">${product.description || 'ì„¤ëª… ì—†ìŒ'}</p>
          <div class="flex justify-between items-center mb-3">
            <span class="font-bold text-sm sm:text-base" style="color: var(--primary-color, #346135)">${product.points}P</span>
            <span class="text-xs sm:text-sm text-gray-500 whitespace-nowrap">ì¬ê³ : ${product.stock}ê°œ</span>
          </div>
          <button 
            onclick="showPurchaseModal('${product.__backendId}')" 
            class="w-full py-2 font-semibold rounded-lg transition text-sm sm:text-base"
            style="background-color: ${(currentUser.points || 0) >= product.points ? 'var(--primary-color, #346135)' : '#d1d5db'}; color: ${(currentUser.points || 0) >= product.points ? 'white' : '#6b7280'}; cursor: ${(currentUser.points || 0) >= product.points ? 'pointer' : 'not-allowed'};"
            ${(currentUser.points || 0) < product.points ? 'disabled' : ''}
          >
            ${(currentUser.points || 0) >= product.points ? 'êµ¬ë§¤í•˜ê¸°' : 'í¬ì¸íŠ¸ ë¶€ì¡±'}
          </button>
        </div>
      `).join('');
    }

    function updateStudentItems() {
      const items = allData.filter(item => 
        item.type === 'item' && 
        item.studentId === currentUser.__backendId
      );
      const itemsContainer = document.getElementById('studentItemsList');
      
      if (items.length === 0) {
        itemsContainer.innerHTML = '<p class="text-gray-500 text-center py-8 col-span-full">ë³´ìœ í•œ ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤</p>';
        return;
      }
      
      itemsContainer.innerHTML = items.map(item => `
        <div class="product-card bg-white p-3 sm:p-4 rounded-lg border shadow-sm">
          <h4 class="font-semibold text-gray-800 mb-2 text-sm sm:text-base truncate">${item.productName}</h4>
          <p class="text-xs sm:text-sm text-gray-600 mb-3 line-clamp-2">${item.productDescription || 'ì„¤ëª… ì—†ìŒ'}</p>
          <div class="flex justify-between items-center mb-3">
            <span class="text-xs sm:text-sm text-gray-500">êµ¬ë§¤ì¼: ${new Date(item.createdAt).toLocaleDateString()}</span>
          </div>
          <button 
            onclick="showUseItemModal('${item.__backendId}')" 
            class="w-full py-2 font-semibold rounded-lg transition text-sm sm:text-base text-white"
            style="background-color: var(--secondary-color, #B29146);"
          >
            ì‚¬ìš©í•˜ê¸°
          </button>
        </div>
      `).join('');
    }

    function handleLogout() {
      currentUser = null;
      
      // ëŒ€ì‹œë³´ë“œ ìˆ¨ê¸°ê¸°
      document.getElementById('teacherDashboard').style.display = 'none';
      
      // ë„¤ë¹„ê²Œì´ì…˜ ë°” ë³´ì´ê¸°
      document.getElementById('navbar').style.display = 'block';
      
      // ëª¨ë“  ì„¹ì…˜ ë³´ì´ê¸°
      document.querySelectorAll('section').forEach(section => {
        section.style.display = 'block';
      });
      
      // í‘¸í„° ë³´ì´ê¸°
      document.querySelector('footer').style.display = 'block';
      
      showToast('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
    }

    function handleStudentLogout() {
      currentUser = null;
      
      // ëŒ€ì‹œë³´ë“œ ìˆ¨ê¸°ê¸°
      document.getElementById('studentDashboard').style.display = 'none';
      
      // ë„¤ë¹„ê²Œì´ì…˜ ë°” ë³´ì´ê¸°
      document.getElementById('navbar').style.display = 'block';
      
      // ëª¨ë“  ì„¹ì…˜ ë³´ì´ê¸°
      document.querySelectorAll('section').forEach(section => {
        section.style.display = 'block';
      });
      
      // í‘¸í„° ë³´ì´ê¸°
      document.querySelector('footer').style.display = 'block';
      
      showToast('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
    }

    function switchTab(contentId, tabId) {
      // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
      document.querySelectorAll('.dashboard-content').forEach(content => {
        content.style.display = 'none';
      });
      
      // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
      document.querySelectorAll('.dashboard-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // ì„ íƒëœ íƒ­ í™œì„±í™”
      document.getElementById(contentId).style.display = 'block';
      document.getElementById(tabId).classList.add('active');
    }

    function switchStudentTab(contentId, tabId) {
      // ëª¨ë“  í•™ìƒ íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
      document.getElementById('studentPointsHistory').style.display = 'none';
      document.getElementById('studentMarket').style.display = 'none';
      document.getElementById('studentItems').style.display = 'none';
      
      // ëª¨ë“  í•™ìƒ íƒ­ ë¹„í™œì„±í™”
      document.getElementById('studentPointsTab').classList.remove('active');
      document.getElementById('studentMarketTab').classList.remove('active');
      document.getElementById('studentItemsTab').classList.remove('active');
      
      // ì„ íƒëœ íƒ­ í™œì„±í™”
      document.getElementById(contentId).style.display = 'block';
      document.getElementById(tabId).classList.add('active');
    }

    let selectedProduct = null;
    let selectedItem = null;

    function showPurchaseModal(productId) {
      const product = allData.find(p => p.__backendId === productId);
      if (!product) return;
      
      selectedProduct = product;
      
      document.getElementById('purchaseDetails').innerHTML = `
        <div class="text-center">
          <h3 class="text-xl font-bold text-gray-800 mb-2">${product.name}</h3>
          <p class="text-gray-600 mb-4">${product.description || 'ì„¤ëª… ì—†ìŒ'}</p>
          <div class="bg-gray-50 p-4 rounded-lg mb-4">
            <div class="flex justify-between items-center mb-2">
              <span class="text-gray-700">í•„ìš” í¬ì¸íŠ¸:</span>
              <span class="font-bold" style="color: var(--primary-color, #346135)">${product.points}P</span>
            </div>
            <div class="flex justify-between items-center mb-2">
              <span class="text-gray-700">ë³´ìœ  í¬ì¸íŠ¸:</span>
              <span class="text-green-600 font-bold">${currentUser.points || 0}P</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-gray-700">êµ¬ë§¤ í›„ ì”ì—¬:</span>
              <span class="text-blue-600 font-bold">${(currentUser.points || 0) - product.points}P</span>
            </div>
          </div>
          <p class="text-sm text-gray-600">ì •ë§ë¡œ ì´ ìƒí’ˆì„ êµ¬ë§¤í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
        </div>
      `;
      
      document.getElementById('purchaseModal').classList.add('active');
    }

    function showUseItemModal(itemId) {
      const item = allData.find(i => i.__backendId === itemId);
      if (!item) return;
      
      selectedItem = item;
      
      document.getElementById('useItemDetails').innerHTML = `
        <div class="text-center">
          <h3 class="text-xl font-bold text-gray-800 mb-2">${item.productName}</h3>
          <p class="text-gray-600 mb-4">${item.productDescription || 'ì„¤ëª… ì—†ìŒ'}</p>
          <div class="bg-gray-50 p-4 rounded-lg mb-4">
            <div class="flex justify-between items-center">
              <span class="text-gray-700">êµ¬ë§¤ì¼:</span>
              <span class="text-gray-600 font-semibold">${new Date(item.createdAt).toLocaleDateString()}</span>
            </div>
          </div>
          <p class="text-sm text-gray-600">ì´ ì•„ì´í…œì„ ì‚¬ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
          <p class="text-xs text-red-500 mt-2">ì‚¬ìš©í•œ ì•„ì´í…œì€ ë³´ìœ  ëª©ë¡ì—ì„œ ì‚­ì œë©ë‹ˆë‹¤.</p>
        </div>
      `;
      
      document.getElementById('useItemModal').classList.add('active');
    }

    async function handlePurchaseConfirm() {
      if (!selectedProduct) return;
      
      if (currentRecordCount >= 999) {
        showToast('ìµœëŒ€ 999ê°œì˜ ë°ì´í„°ë§Œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤', 'error');
        return;
      }

      const confirmBtn = document.getElementById('confirmPurchase');
      confirmBtn.disabled = true;
      confirmBtn.textContent = 'êµ¬ë§¤ ì¤‘...';

      // í•™ìƒ í¬ì¸íŠ¸ ì°¨ê°
      const updatedStudent = { 
        ...currentUser, 
        points: (currentUser.points || 0) - selectedProduct.points 
      };
      const studentResult = await window.dataSdk.update(updatedStudent);

      // ìƒí’ˆ ì¬ê³  ì°¨ê°
      const updatedProduct = { 
        ...selectedProduct, 
        stock: selectedProduct.stock - 1 
      };
      const productResult = await window.dataSdk.update(updatedProduct);

      // êµ¬ë§¤ ê¸°ë¡ ìƒì„±
      const purchaseResult = await window.dataSdk.create({
        id: Date.now().toString(),
        type: 'purchase',
        studentId: currentUser.__backendId,
        studentName: currentUser.name,
        productId: selectedProduct.__backendId,
        productName: selectedProduct.name,
        points: selectedProduct.points,
        teacherId: currentUser.teacherId,
        createdAt: new Date().toISOString()
      });

      // ë³´ìœ  ì•„ì´í…œ ìƒì„±
      const itemResult = await window.dataSdk.create({
        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
        type: 'item',
        studentId: currentUser.__backendId,
        studentName: currentUser.name,
        productId: selectedProduct.__backendId,
        productName: selectedProduct.name,
        productDescription: selectedProduct.description,
        teacherId: currentUser.teacherId,
        createdAt: new Date().toISOString()
      });

      confirmBtn.disabled = false;
      confirmBtn.textContent = 'êµ¬ë§¤ í™•ì¸';

      if (studentResult.isOk && productResult.isOk && purchaseResult.isOk && itemResult.isOk) {
        showToast(`${selectedProduct.name}ì„(ë¥¼) ì„±ê³µì ìœ¼ë¡œ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤!`, 'success');
        document.getElementById('purchaseModal').classList.remove('active');
        selectedProduct = null;
      } else {
        showToast('êµ¬ë§¤ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
      }
    }

    async function handleUseItemConfirm() {
      if (!selectedItem) return;

      const confirmBtn = document.getElementById('confirmUseItem');
      confirmBtn.disabled = true;
      confirmBtn.textContent = 'ì‚¬ìš© ì¤‘...';

      // ì•„ì´í…œ ì‚­ì œ
      const result = await window.dataSdk.delete(selectedItem);

      confirmBtn.disabled = false;
      confirmBtn.textContent = 'ì‚¬ìš©';

      if (result.isOk) {
        showToast(`${selectedItem.productName}ì„(ë¥¼) ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤!`, 'success');
        document.getElementById('useItemModal').classList.remove('active');
        selectedItem = null;
      } else {
        showToast('ì•„ì´í…œ ì‚¬ìš©ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'error');
      }
    }

    async function handleCreateClass(e) {
      e.preventDefault();
      
      if (currentRecordCount >= 999) {
        showToast('ìµœëŒ€ 999ê°œì˜ ë°ì´í„°ë§Œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤', 'error');
        return;
      }

      const submitBtn = document.getElementById('createClassBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ìƒì„± ì¤‘...';

      const name = document.getElementById('className').value;
      const grade = document.getElementById('classGrade').value;
      
      // 6ìë¦¬ ê³ ìœ  í•™ê¸‰ì½”ë“œ ìƒì„± (ì‹œê°„ ê¸°ë°˜ + ëœë¤)
      const timestamp = Date.now().toString();
      const randomChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let code = '';
      
      // ì‹œê°„ ê¸°ë°˜ 3ìë¦¬ + ëœë¤ 3ìë¦¬ë¡œ ê³ ìœ ì„± ë³´ì¥
      for (let i = 0; i < 3; i++) {
        const timeIndex = parseInt(timestamp.charAt(timestamp.length - 1 - i)) % randomChars.length;
        code += randomChars[timeIndex];
      }
      for (let i = 0; i < 3; i++) {
        const randomIndex = Math.floor(Math.random() * randomChars.length);
        code += randomChars[randomIndex];
      }

      const result = await window.dataSdk.create({
        id: Date.now().toString(),
        type: 'class',
        name: name,
        grade: grade,
        code: code,
        teacherId: currentUser.__backendId,
        createdAt: new Date().toISOString()
      });

      submitBtn.disabled = false;
      submitBtn.textContent = 'í•™ê¸‰ ìƒì„±';

      if (result.isOk) {
        showToast('í•™ê¸‰ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        document.getElementById('createClassForm').reset();
      } else {
        showToast('í•™ê¸‰ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤', 'error');
      }
    }

    async function handleBulkStudentRegistration(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('bulkStudentBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ë“±ë¡ ì¤‘...';

      const classId = document.getElementById('studentClassSelect').value;
      const studentListText = document.getElementById('studentList').value;
      
      const selectedClass = allData.find(cls => cls.__backendId === classId);
      if (!selectedClass) {
        showToast('í•™ê¸‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
        submitBtn.disabled = false;
        submitBtn.textContent = 'í•™ìƒ ì¼ê´„ ë“±ë¡';
        return;
      }

      const students = studentListText.split('\n').filter(line => line.trim());
      let successCount = 0;

      for (const studentLine of students) {
        if (currentRecordCount + successCount >= 999) {
          showToast('ìµœëŒ€ 999ê°œì˜ ë°ì´í„° ì œí•œì— ë„ë‹¬í–ˆìŠµë‹ˆë‹¤', 'error');
          break;
        }

        const [number, name] = studentLine.split(',').map(s => s.trim());
        if (number && name) {
          const result = await window.dataSdk.create({
            id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
            type: 'student',
            number: parseInt(number),
            name: name,
            classId: classId,
            className: selectedClass.name,
            classCode: selectedClass.code,
            teacherId: currentUser.__backendId,
            points: 0,
            createdAt: new Date().toISOString()
          });
          
          if (result.isOk) {
            successCount++;
          }
        }
      }

      submitBtn.disabled = false;
      submitBtn.textContent = 'í•™ìƒ ì¼ê´„ ë“±ë¡';

      if (successCount > 0) {
        showToast(`${successCount}ëª…ì˜ í•™ìƒì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!`, 'success');
        document.getElementById('bulkStudentForm').reset();
      } else {
        showToast('í•™ìƒ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤', 'error');
      }
    }

    function updateStudentOptions() {
      const classId = document.getElementById('pointsClassSelect').value;
      const studentSelect = document.getElementById('pointsStudentSelect');
      
      if (!classId) {
        studentSelect.innerHTML = '<option value="">í•™ìƒì„ ì„ íƒí•˜ì„¸ìš”</option>';
        return;
      }
      
      const students = allData.filter(item => 
        item.type === 'student' && 
        item.classId === classId && 
        item.teacherId === currentUser.__backendId
      );
      
      const studentOptions = students.map(student => 
        `<option value="${student.__backendId}">${student.number}ë²ˆ ${student.name}</option>`
      ).join('');
      
      studentSelect.innerHTML = '<option value="">í•™ìƒì„ ì„ íƒí•˜ì„¸ìš”</option>' + studentOptions;
    }

    async function handleGivePoints(e) {
      e.preventDefault();
      
      if (currentRecordCount >= 999) {
        showToast('ìµœëŒ€ 999ê°œì˜ ë°ì´í„°ë§Œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤', 'error');
        return;
      }

      const submitBtn = document.getElementById('givePointsBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ì§€ê¸‰ ì¤‘...';

      const studentId = document.getElementById('pointsStudentSelect').value;
      const amount = parseInt(document.getElementById('pointsAmount').value);
      const reason = document.getElementById('pointsReason').value;
      
      const student = allData.find(s => s.__backendId === studentId);
      if (!student) {
        showToast('í•™ìƒì„ ì„ íƒí•´ì£¼ì„¸ìš”', 'error');
        submitBtn.disabled = false;
        submitBtn.textContent = 'í¬ì¸íŠ¸ ì§€ê¸‰';
        return;
      }

      // í¬ì¸íŠ¸ ì§€ê¸‰ ê¸°ë¡ ìƒì„±
      const pointsResult = await window.dataSdk.create({
        id: Date.now().toString(),
        type: 'points',
        studentId: studentId,
        studentName: student.name,
        amount: amount,
        reason: reason,
        teacherId: currentUser.__backendId,
        createdAt: new Date().toISOString()
      });

      // í•™ìƒ í¬ì¸íŠ¸ ì—…ë°ì´íŠ¸
      const updatedStudent = { ...student, points: (student.points || 0) + amount };
      const updateResult = await window.dataSdk.update(updatedStudent);

      submitBtn.disabled = false;
      submitBtn.textContent = 'í¬ì¸íŠ¸ ì§€ê¸‰';

      if (pointsResult.isOk && updateResult.isOk) {
        showToast(`${student.name}ì—ê²Œ ${amount}Pë¥¼ ì§€ê¸‰í–ˆìŠµë‹ˆë‹¤!`, 'success');
        document.getElementById('givePointsForm').reset();
      } else {
        showToast('í¬ì¸íŠ¸ ì§€ê¸‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤', 'error');
      }
    }

    async function handleAddProduct(e) {
      e.preventDefault();
      
      if (currentRecordCount >= 999) {
        showToast('ìµœëŒ€ 999ê°œì˜ ë°ì´í„°ë§Œ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤', 'error');
        return;
      }

      const submitBtn = document.getElementById('addProductBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'ë“±ë¡ ì¤‘...';

      const classId = document.getElementById('productClassSelect').value;
      const name = document.getElementById('productName').value;
      const points = parseInt(document.getElementById('productPoints').value);
      const description = document.getElementById('productDescription').value;
      const stock = parseInt(document.getElementById('productStock').value);

      const result = await window.dataSdk.create({
        id: Date.now().toString(),
        type: 'product',
        name: name,
        points: points,
        description: description,
        stock: stock,
        classId: classId,
        teacherId: currentUser.__backendId,
        createdAt: new Date().toISOString()
      });

      submitBtn.disabled = false;
      submitBtn.textContent = 'ìƒí’ˆ ë“±ë¡';

      if (result.isOk) {
        showToast('ìƒí’ˆì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        document.getElementById('addProductForm').reset();
      } else {
        showToast('ìƒí’ˆ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤', 'error');
      }
    }

    let originalProductContent = {};

    async function deleteProduct(productId) {
      const product = allData.find(p => p.__backendId === productId);
      if (!product) return;

      // ì¸ë¼ì¸ í™•ì¸ UI ìƒì„±
      const productCard = event.target.closest('.product-card');
      originalProductContent[productId] = productCard.innerHTML;
      
      productCard.innerHTML = `
        <div class="text-center p-4">
          <p class="text-gray-800 font-semibold mb-3">"${product.name}" ìƒí’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
          <div class="flex gap-2">
            <button onclick="confirmDelete('${productId}')" class="flex-1 py-2 bg-red-500 text-white font-semibold rounded-lg hover:bg-red-600 transition">
              ì‚­ì œ
            </button>
            <button onclick="cancelDelete('${productId}')" class="flex-1 py-2 bg-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-400 transition">
              ì·¨ì†Œ
            </button>
          </div>
        </div>
      `;
    }

    async function confirmDelete(productId) {
      const product = allData.find(p => p.__backendId === productId);
      if (!product) return;

      const result = await window.dataSdk.delete(product);

      if (result.isOk) {
        showToast('ìƒí’ˆì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
      } else {
        showToast('ìƒí’ˆ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤', 'error');
      }
    }

    function cancelDelete(productId) {
      const productCard = document.querySelector(`[onclick*="confirmDelete('${productId}')"]`).closest('.product-card');
      if (originalProductContent[productId]) {
        productCard.innerHTML = originalProductContent[productId];
        delete originalProductContent[productId];
      }
    }

    // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ
    window.deleteProduct = deleteProduct;
    window.confirmDelete = confirmDelete;
    window.cancelDelete = cancelDelete;
    window.showPurchaseModal = showPurchaseModal;
    window.showUseItemModal = showUseItemModal;

    initializeApp();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99a7b409b605ea33',t:'MTc2MjQ2NDc0NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
